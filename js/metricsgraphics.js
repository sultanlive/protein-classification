!function(t,e){"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?module.exports=e(require("d3")):t.MG=e(t.d3)}(this,(function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function r(){return"undefined"!=typeof jQuery||"undefined"!=typeof $}function a(t,e){return t[e.x_accessor]>=e.processed.min_x&&t[e.x_accessor]<=e.processed.max_x&&t[e.y_accessor]>=e.processed.min_y&&t[e.y_accessor]<=e.processed.max_y}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(e){var r=e.map((function(t){return!0===n(t)&&t.length>0}));return t.sum(r)===e.length}function i(e){var r=e.map((function(t){return!0==(e=t,"[object Object]"===Object.prototype.toString.call(e));var e}));return t.sum(r)===e.length}function s(t){return n(e=t)&&0===e.length||i(t);var e}function c(t){return t.height-t.bottom}function l(t){return c(t)-t.buffer}function u(t){return t.top}function f(t){return u(t)+t.buffer}function d(t){return t.left}function p(t){return d(t)+t.buffer}function _(t){return t.width-t.right}function m(t){return _(t)-t.buffer}function g(t){t.exit().remove()}function h(t,e){t.selectAll(e).remove()}function x(t,e){return t.append("g").classed(e,!0)}function y(t,e){var r=A(t.target),a=D(t.data),n=r.selectAll("line."+e).data(a);return n.enter().append("line").attr("class",e).attr("opacity",.3),g(n),g(n),n}function v(t,e,r){e.color_accessor?(t.attr("stroke",e.scalefns.colorf),t.classed(r,!1)):(t.attr("stroke",null),t.classed(r,!0))}function b(e,r){r&&e.attr({dy:0,transform:function(){var e=t.select(this);return"rotate("+r+" "+e.attr("x")+","+e.attr("y")+")"}})}function w(t){if(!(t=t.node()))return!1;for(var e=0;e<t.length;e++)if(M(t[e],t))return!0;return!1}function k(t,e){var r=t.getBoundingClientRect(),a=e.getBoundingClientRect();return r.top<=a.bottom&&r.top>=a.top&&a.bottom-r.top}function M(t,e){for(var r=t.getBoundingClientRect(),a=0;a<e.length;a++)if(e[a]!=t){var n=e[a].getBoundingClientRect();if(r.top===n.top&&!(n.left>r.right||n.right<r.left))return!0}return!1}function G(t,e){var r=D(t.data);return"string"==typeof(r=r[0][t[e+"_accessor"]])?"categorical":"numerical"}function A(e){return t.select(e).select("svg")}function D(t){var e=[];return e.concat.apply(e,t)}function O(t){if("string"==typeof t)return z(t);if(t instanceof window.HTMLElement){var e=t.getAttribute("data-mg-uid");return e||(void 0===MG._next_elem_id&&(MG._next_elem_id=0),e="mg-"+MG._next_elem_id++,t.setAttribute("data-mg-uid",e)),e}return console.warn("The specified target should be a string or an HTMLElement.",t),z(t)}function z(t){return t.replace(/[^a-zA-Z0-9 _-]+/g,"").replace(/ +?/g,"")}function F(e,r){return Number(t.select(e).style(r).replace(/px/g,""))}function C(t){return F(t,"width")}("undefined"==typeof window?global:window).MG={version:"2.11"},MG.convert={},MG.convert.date=function(e,r,a){a=void 0===a?"%Y-%m-%d":a;var n=t.timeParse(a);return e=e.map((function(t){return t[r]=n(t[r].trim()),t}))},MG.convert.number=function(t,e){return t=t.map((function(t){return t[e]=Number(t[e]),t}))},MG.time_format=function(e,r){return e?t.utcFormat(r):t.timeFormat(r)};var T=function(t,e,r){var a={};if(null===t)return t;if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,o=t.length;n<o;n++)if(e.call(r,t[n],n,t)===a)return}else for(var i in t)if(e.call(r,t[i],i,t)===a)return;return t};function R(t){return T(Array.prototype.slice.call(arguments,1),(function(e){if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r])})),t}function E(t){return"[object Date]"===Object.prototype.toString.call(t)}function Y(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function P(t){return"[object Function]"===Object.prototype.toString.call(t)}function S(t,e){var r,a=[],n=[];for(r=0;r<e.length;r++)a[e[r]]=!0;for(r=0;r<t.length;r++)a[t[r]]||n.push(t[r]);return n}function L(t,e){console.warn("Deprecation: "+t+(e?". This feature will be removed in "+e+".":" the near future.")),console.trace()}function j(t,e,r){var a,n=0;for(t.textContent=e,a=t.getBBox();a.width>r&&(t.textContent=e.slice(0,--n)+"...",a=t.getBBox(),"..."!==t.textContent););}function X(e){var a=A(e.target);if(a.select(".mg-header").remove(),e.target&&e.title){var n=a.insert("text").attr("class","mg-header").attr("x",e.center_title_full_width?e.width/2:(e.width+e.left-e.right)/2).attr("y",e.title_y_position).attr("text-anchor","middle").attr("dy","0.55em");if(n.append("tspan").attr("class","mg-chart-title").text(e.title),e.show_tooltips&&e.description&&r()){n.append("tspan").attr("class","mg-chart-description").attr("dx","0.3em").text("ÔÅô");var o=$(n.node());o.popover({html:!0,animation:!1,placement:"top",content:e.description,container:e.target,trigger:"manual",template:'<div class="popover mg-popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'}).on("mouseenter",(function(){t.selectAll(e.target).selectAll(".mg-popover").remove(),$(this).popover("show"),$(t.select(e.target).select(".popover").node()).on("mouseleave",(function(){o.popover("hide")}))})).on("mouseleave",(function(){setTimeout((function(){$(".popover:hover").length||o.popover("hide")}),120)}))}else e.show_tooltips&&e.description&&"undefined"==typeof $&&(e.error="In order to enable tooltips, please make sure you include jQuery.")}e.error&&We(e)}function U(t,e,r,a,n){t.scalefns[e]=function(e){return void 0===n?t.scales[r](e[a]):t.scales[r](e[a])+n}}function N(t,e){return"bottom"===t||"top"===t?[p(e),m(e)]:"left"===t||"right"===t?[l(e),e.top]:void 0}function B(e,r,a){var n=r.namespace,o=r.namespace_accessor_name,i=r.use_inflator,s=r.zero_bottom,c=e[o],l=D(e.data).map((function(t){return t[c]})).concat(D(a));"log"===e[n+"_scale_type"]&&(l=l.filter((function(t){return t>0})));var u=t.extent(l),f=u[0],d=u[1];s&&!e["min_"+n+"_from_data"]&&f>0&&!r.is_time_series&&(f="log"===e[n+"_scale_type"]?1:0),"log"!==e[n+"_scale_type"]&&f<0&&!r.is_time_series&&(f-=(f-f*e.inflator)*i),r.is_time_series||(d=d<0?d+(d-d*e.inflator)*i:d*(i?e.inflator:1)),(f=null!=e["min_"+n]?e["min_"+n]:f)===(d=null!=e["max_"+n]?e["max_"+n]:d)&&null==e["min_"+n]&&null==e["max_"+n]&&(E(f)?d=new Date(MG.clone(f).setDate(f.getDate()+1)):"number"==typeof f&&(d=f+1,function(t){t.xax_count=2}(e))),e.processed["min_"+n]=f,e.processed["max_"+n]=d,e.processed["zoom_"+n]&&(e.processed["min_"+n]=e.processed["zoom_"+n][0],e.processed["max_"+n]=e.processed["zoom_"+n][1]),MG.call_hook("x_axis.process_min_max",e,e.processed.min_x,e.processed.max_x),MG.call_hook("y_axis.process_min_max",e,e.processed.min_y,e.processed.max_y)}function I(e){var r,a,n;return null===e.color_domain?"number"===e.color_type?r=t.extent(e.data[0],(function(t){return t[e.color_accessor]})):"category"===e.color_type&&(a=e.data[0],n=e.color_accessor,r=t.set(a.map((function(t){return t[n]}))).values()):r=e.color_domain,r}function H(t){return null===t.color_range?"number"===t.color_type?["blue","red"]:null:t.color_range}function q(e,r,a){var n=yt(e),o=n.secondary(e.processed.min_x,e.processed.max_x);0===o.length&&(o=[e.scales.X.ticks(e.xax_count)[0]]);var i=x(a,"mg-year-marker");"default"===n.timeframe&&e.show_year_markers&&function(t,e,r,a,n){r.selectAll(".mg-year-marker").data(a).enter().append("line").attr("x1",(function(e){return t.scales.X(e).toFixed(2)})).attr("x2",(function(e){return t.scales.X(e).toFixed(2)})).attr("y1",u(t)).attr("y2",c(t))}(e,0,i,o,n.yformat),"years"!=n.tick_diff_timeframe&&function(e,r,a,n,o){var i,s,l,f,d,p=r.position,_=r.namespace,m=e.scales[_.toUpperCase()],g=t.select(e.target).select(".mg-x-axis text").node().getBoundingClientRect();"top"===p&&(i=function(t,e){return m(t).toFixed(2)},s=u(e)-7*e.xax_tick_length/3-g.height,l=".50em",f="middle",d=function(t){return o(new Date(t))});"bottom"===p&&(i=function(t,e){return m(t).toFixed(2)},s=c(e)+7*e.xax_tick_length/3+.8*g.height,l=".50em",f="middle",d=function(t){return o(new Date(t))});a.selectAll(".mg-year-marker").data(n).enter().append("text").attr("x",i).attr("y",s).attr("dy",l).attr("text-anchor",f).text(d)}(e,r,i,o,n.yformat)}function V(e,r,a){var n=a.namespace,o=function(t,e){var r=e.position,a=e.namespace,n=t[a+"ax_tick_length"],o=t.scales[a.toUpperCase()],i={};return"left"===r&&(i.x=d(t)-3*n/2,i.y=function(t){return o(t).toFixed(2)},i.dx=-3,i.dy=".35em",i.textAnchor="end",i.text=function(e){return tt(t)(e)}),"right"===r&&(i.x=_(t)+3*n/2,i.y=function(t){return o(t).toFixed(2)},i.dx=3,i.dy=".35em",i.textAnchor="start",i.text=function(e){return tt(t)(e)}),"top"===r&&(i.x=function(t){return o(t).toFixed(2)},i.y=(u(t)-7*n/3).toFixed(2),i.dx=0,i.dy="0em",i.textAnchor="middle",i.text=function(e){return xt(t)(e)}),"bottom"===r&&(i.x=function(t){return o(t).toFixed(2)},i.y=(c(t)+7*n/3).toFixed(2),i.dx=0,i.dy=".50em",i.textAnchor="middle",i.text=function(e){return xt(t)(e)}),i}(r,a),i=r.processed[n+"_ticks"],s=e.selectAll(".mg-yax-labels").data(i).enter().append("text").attr("x",o.x).attr("dx",o.dx).attr("y",o.y).attr("dy",o.dy).attr("text-anchor",o.textAnchor).text(o.text);("x"==n&&(r.time_series&&r.european_clock?(s.append("tspan").classed("mg-european-hours",!0).text((function(e,r){var a=new Date(e);return 0===r?t.timeFormat("%H")(a):""})),s.append("tspan").classed("mg-european-minutes-seconds",!0).text((function(t,e){var a=new Date(t);return":"+r.processed.xax_format(a)}))):s.text((function(t){return r.xax_units+r.processed.xax_format(t)})),r.time_series&&(r.show_years||r.show_secondary_x_label)&&q(r,a,e)),w(s))&&(s.filter((function(t,e){return(e+1)%2==0})).remove(),A(r.target).selectAll(".mg-"+n+"ax-ticks").filter((function(t,e){return(e+1)%2==0})).remove())}function W(t,e,r){var a=r.namespace,n=e.processed[a+"_ticks"].length,o=function(t,e){var r=e.namespace,a=e.position,n=t.processed[r+"_ticks"].length,o=t.processed[r+"_ticks"],i=t.scales[r.toUpperCase()],s={};return"left"===a&&(s.x1=d(t),s.x2=d(t),s.y1=i(o[0]).toFixed(2),s.y2=i(o[n-1]).toFixed(2)),"right"===a&&(s.x1=_(t),s.x2=_(t),s.y1=i(o[0]).toFixed(2),s.y2=i(o[n-1]).toFixed(2)),"top"===a&&(s.x1=d(t),s.x2=_(t),s.y1=u(t),s.y2=u(t)),"bottom"===a&&(s.x1=d(t),s.x2=_(t),s.y1=c(t),s.y2=c(t)),"left"!==a&&"right"!==a||(t.axes_not_compact?(s.y1=c(t),s.y2=u(t)):n&&(s.y1=i(o[0]).toFixed(2),s.y2=i(o[n-1]).toFixed(2))),s}(e,r);e[a+"_extended_ticks"]||e[a+"_extended_ticks"]||!n||t.append("line").attr("x1",o.x1).attr("x2",o.x2).attr("y1",o.y1).attr("y2",o.y2)}function Q(t,e){t.rug_buffer_size="point"===t.chart_type?t.buffer/2:2*t.buffer/3;var r=function(t,e){var r=A(t.target),a=D(t.data),n=r.selectAll("line."+e).data(a);return n.enter().append("svg:line").attr("class",e).attr("opacity",.3),g(n),g(n),n}(t,"mg-"+e.namespace+"-rug"),a=function(t,e){var r=e.position,a=e.namespace,n={};return"left"===r&&(n.x1=d(t)+1,n.x2=d(t)+t.rug_buffer_size,n.y1=t.scalefns[a+"f"],n.y2=t.scalefns[a+"f"]),"right"===r&&(n.x1=_(t)-1,n.x2=_(t)-t.rug_buffer_size,n.y1=t.scalefns[a+"f"],n.y2=t.scalefns[a+"f"]),"top"===r&&(n.x1=t.scalefns[a+"f"],n.x2=t.scalefns[a+"f"],n.y1=u(t)+1,n.y2=u(t)+t.rug_buffer_size),"bottom"===r&&(n.x1=t.scalefns[a+"f"],n.x2=t.scalefns[a+"f"],n.y1=c(t)-1,n.y2=c(t)-t.rug_buffer_size),n}(t,e);r.attr("x1",a.x1).attr("x2",a.x2).attr("y1",a.y1).attr("y2",a.y2),v(r,t,"mg-"+e.namespace+"-rug-mono")}function Z(e,r){var a=r.namespace,n="mg-"+a+"-axis",o=e.scales[a.toUpperCase()],i=e.scales[(a+"group").toUpperCase()],s=a+"group_accessor",c=A(e.target);h(c,"."+n);var u,d=x(c,n);(i.domain&&i.domain()?i.domain():["1"]).forEach((function(n){var i=function(t,e,r){var a=e.namespace,n=e.position,o=t.scales[a.toUpperCase()],i=t.scales[(a+"group").toUpperCase()],s={cat:{},group:{}};return"left"===n&&(s.cat.x=p(t)-t.buffer,s.cat.y=function(t){return i(r)+o(t)+o.bandwidth()/2},s.cat.dy=".35em",s.cat.textAnchor="end",s.group.x=p(t)-t.buffer,s.group.y=i(r)+(i.bandwidth?i.bandwidth()/2:0),s.group.dy=".35em",s.group.textAnchor=(t["rotate_"+a+"_labels"],"end")),"right"===n&&(s.cat.x=m(t)-t.buffer,s.cat.y=function(t){return i(r)+o(t)+o.bandwidth()/2},s.cat.dy=".35em",s.cat.textAnchor="start",s.group.x=m(t)-t.buffer,s.group.y=i(r)+(i.bandwidth?i.bandwidth()/2:0),s.group.dy=".35em",s.group.textAnchor="start"),"top"===n&&(s.cat.x=function(t){return i(r)+o(t)+o.bandwidth()/2},s.cat.y=f(t)+t.buffer,s.cat.dy=".35em",s.cat.textAnchor=t["rotate_"+a+"_labels"]?"start":"middle",s.group.x=i(r)+(i.bandwidth?i.bandwidth()/2:0),s.group.y=f(t)+t.buffer,s.group.dy=".35em",s.group.textAnchor=t["rotate_"+a+"_labels"]?"start":"middle"),"bottom"===n&&(s.cat.x=function(t){return i(r)+o(t)+o.bandwidth()/2},s.cat.y=l(t)+t.buffer,s.cat.dy=".35em",s.cat.textAnchor=t["rotate_"+a+"_labels"]?"start":"middle",s.group.x=i(r)+(i.bandwidth?i.bandwidth()/2-o.bandwidth()/2:0),s.group.y=l(t)+t.buffer,s.group.dy=".35em",s.group.textAnchor=t["rotate_"+a+"_labels"]?"start":"middle"),s}(e,r,n);if(u=x(d,"mg-group-"+z(n)),null!==e[s])var c=u.append("text").classed("mg-barplot-group-label",!0).attr("x",i.group.x).attr("y",i.group.y).attr("dy",i.group.dy).attr("text-anchor",i.group.textAnchor).text(n);else c=u.selectAll("text").data(o.domain()).enter().append("text").attr("x",i.cat.x).attr("y",i.cat.y).attr("dy",i.cat.dy).attr("text-anchor",i.cat.textAnchor).text(String);e["rotate_"+a+"_labels"]&&function(e,r){r&&e.attr("transform",(function(){var e=t.select(this);return"rotate("+r+" "+e.attr("x")+","+e.attr("y")+")"}))}(c,e["rotate_"+a+"_labels"])}))}MG.merge_with_defaults=R,MG.clone=function(t){var r;if(null===t||"object"!==(void 0===t?"undefined":e(t)))return t;if(E(t))return(r=new Date).setTime(t.getTime()),r;if(Y(t)){r=[];for(var a=0,n=t.length;a<n;a++)r[a]=MG.clone(t[a]);return r}if(function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)){for(var o in r={},t)t.hasOwnProperty(o)&&(r[o]=MG.clone(t[o]));return r}throw new Error("Unable to copy obj! Its type isn't supported.")},MG.arr_diff=S,MG.warn_deprecation=L,MG.truncate_text=j,MG.wrap_text=function(e,r,a,n){e.each((function(){for(var e,o=t.select(this),i=o.text().split(a||/\s+/).reverse(),s=[],c=0,l=(o.attr("y"),o.text(null).append("tspan").attr("x",0).attr("y","0em").attr(n||{}));e=i.pop();)s.push(e),l.text(s.join(" ")),(null===r||l.node().getComputedTextLength()>r)&&(s.pop(),l.text(s.join(" ")),s=[e],l=o.append("tspan").attr("x",0).attr("y",1.1*++c+0+"em").attr(n||{}).text(e))}))},MG.register=function(t,e,r){MG.charts[t]={descriptor:e,defaults:r||{}}},MG._hooks={},MG.add_hook=function(t,e,r){var a;if(MG._hooks[t]||(MG._hooks[t]=[]),(a=MG._hooks[t]).filter((function(t){return t.func===e})).length>0)throw"That function is already registered.";a.push({func:e,context:r})},MG.call_hook=function(t){var e,r=MG._hooks[t],a=[].slice.apply(arguments,[1]);return r&&r.forEach((function(t){if(t.func){var r=e||a;r&&r.constructor!==Array&&(r=[r]),r=[].concat.apply([],r),e=t.func.apply(t.context,r)}})),e||a},MG.globals={},MG.deprecations={rollover_callback:{replacement:"mouseover",version:"2.0"},rollout_callback:{replacement:"mouseout",version:"2.0"},x_rollover_format:{replacement:"x_mouseover",version:"2.10"},y_rollover_format:{replacement:"y_mouseover",version:"2.10"},show_years:{replacement:"show_secondary_x_label",version:"2.1"},xax_start_at_min:{replacement:"axes_not_compact",version:"2.7"},interpolate_tension:{replacement:"interpolate",version:"2.10"}},MG.globals.link=!1,MG.globals.version="1.1",MG.charts={},MG.data_graphic=function(e){var r={missing_is_zero:!1,missing_is_hidden:!1,missing_is_hidden_accessor:null,legend:"",legend_target:"",error:"",animate_on_load:!1,top:65,title_y_position:10,center_title_full_width:!1,bottom:45,right:10,left:50,buffer:8,width:350,height:220,full_width:!1,full_height:!1,small_height_threshold:120,small_width_threshold:160,xax_count:6,xax_tick_length:5,axes_not_compact:!0,yax_count:3,yax_tick_length:5,x_extended_ticks:!1,y_extended_ticks:!1,y_scale_type:"linear",max_x:null,max_y:null,min_x:null,min_y:null,min_y_from_data:!1,point_size:2.5,active_point_on_lines:!1,active_point_accessor:"active",active_point_size:2,points_always_visible:!1,x_accessor:"date",xax_units:"",x_label:"",x_sort:!0,x_axis:!0,y_axis:!0,x_axis_position:"bottom",y_axis_position:"left",x_axis_type:null,y_axis_type:null,ygroup_accessor:null,xgroup_accessor:null,y_padding_percentage:.05,y_outer_padding_percentage:.1,ygroup_padding_percentage:.25,ygroup_outer_padding_percentage:0,x_padding_percentage:.05,x_outer_padding_percentage:.1,xgroup_padding_percentage:.25,xgroup_outer_padding_percentage:0,y_categorical_show_guides:!1,x_categorical_show_guide:!1,rotate_x_labels:0,rotate_y_labels:0,y_accessor:"value",y_label:"",yax_units:"",yax_units_append:!1,x_rug:!1,y_rug:!1,mouseover_align:"right",x_mouseover:null,y_mouseover:null,transition_on_update:!0,mouseover:null,click:null,show_rollover_text:!0,show_confidence_band:null,xax_format:null,area:!0,flip_area_under_y_value:null,chart_type:"line",data:[],decimals:2,format:"count",inflator:10/9,linked:!1,linked_format:"%Y-%m-%d",list:!1,baselines:null,markers:null,scalefns:{},scales:{},utc_time:!1,european_clock:!1,show_year_markers:!1,show_secondary_x_label:!0,target:"#viz",interpolate:t.curveCatmullRom.alpha(0),custom_line_color_map:[],colors:null,max_data_size:null,aggregate_rollover:!1,show_tooltips:!0,showActivePoint:!0,brush:null,zoom_target:null,brushing_selection_changed:null};MG.call_hook("global.defaults",r),e||(e={});var a=MG.charts[e.chart_type||r.chart_type];for(var n in R(e,a.defaults,r),e.list&&(e.x_accessor=0,e.y_accessor=1),MG.deprecations)if(e.hasOwnProperty(n)){var o=MG.deprecations[n],i="Use of `args."+n+"` has been deprecated",s=o.replacement;if(s&&(e[s]?i+=". The replacement - `args."+s+"` - has already been defined. This definition will be discarded.":e[s]=e[n]),o.warned)continue;o.warned=!0,s&&(i+=" in favor of `args."+s+"`"),L(i,o.version)}return MG.call_hook("global.before_init",e),new a.descriptor(e),e.data},r()&&(function(t){var r=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};r.VERSION="3.3.5",r.TRANSITION_DURATION=150,r.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},r.prototype.init=function(e,r,a){if(this.enabled=!0,this.type=e,this.$element=t(r),this.options=this.getOptions(a),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),o=n.length;o--;){var i=n[o];if("click"==i)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=i){var s="hover"==i?"mouseenter":"focusin",c="hover"==i?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},r.prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.getOptions=function(e){return(e=t.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},r.prototype.getDelegateOptions=function(){var e={},r=this.getDefaults();return this._options&&t.each(this._options,(function(t,a){r[t]!=a&&(e[t]=a)})),e},r.prototype.enter=function(e){var r=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(r||(r=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,r)),e instanceof t.Event&&(r.inState["focusin"==e.type?"focus":"hover"]=!0),r.tip().hasClass("in")||"in"==r.hoverState)r.hoverState="in";else{if(clearTimeout(r.timeout),r.hoverState="in",!r.options.delay||!r.options.delay.show)return r.show();r.timeout=setTimeout((function(){"in"==r.hoverState&&r.show()}),r.options.delay.show)}},r.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},r.prototype.leave=function(e){var r=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(r||(r=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,r)),e instanceof t.Event&&(r.inState["focusout"==e.type?"focus":"hover"]=!1),!r.isInStateTrue()){if(clearTimeout(r.timeout),r.hoverState="out",!r.options.delay||!r.options.delay.hide)return r.hide();r.timeout=setTimeout((function(){"out"==r.hoverState&&r.hide()}),r.options.delay.hide)}},r.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var a=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!a)return;var n=this,o=this.tip(),i=this.getUID(this.type);this.setContent(),o.attr("id",i),this.$element.attr("aria-describedby",i),this.options.animation&&o.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,l=c.test(s);l&&(s=s.replace(c,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var u=this.getPosition(),f=o[0].offsetWidth,d=o[0].offsetHeight;if(l){var p=s,_=this.getPosition(this.$viewport);s="bottom"==s&&u.bottom+d>_.bottom?"top":"top"==s&&u.top-d<_.top?"bottom":"right"==s&&u.right+f>_.width?"left":"left"==s&&u.left-f<_.left?"right":s,o.removeClass(p).addClass(s)}var m=this.getCalculatedOffset(s,u,f,d);this.applyPlacement(m,s);var g=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",g).emulateTransitionEnd(r.TRANSITION_DURATION):g()}},r.prototype.applyPlacement=function(e,r){var a=this.tip(),n=a[0].offsetWidth,o=a[0].offsetHeight,i=parseInt(a.css("margin-top"),10),s=parseInt(a.css("margin-left"),10);isNaN(i)&&(i=0),isNaN(s)&&(s=0),e.top+=i,e.left+=s,t.offset.setOffset(a[0],t.extend({using:function(t){a.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),a.addClass("in");var c=a[0].offsetWidth,l=a[0].offsetHeight;"top"==r&&l!=o&&(e.top=e.top+o-l);var u=this.getViewportAdjustedDelta(r,e,c,l);u.left?e.left+=u.left:e.top+=u.top;var f=/top|bottom/.test(r),d=f?2*u.left-n+c:2*u.top-o+l,p=f?"offsetWidth":"offsetHeight";a.offset(e),this.replaceArrow(d,a[0][p],f)},r.prototype.replaceArrow=function(t,e,r){this.arrow().css(r?"left":"top",50*(1-t/e)+"%").css(r?"top":"left","")},r.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},r.prototype.hide=function(e){var a=this,n=t(this.$tip),o=t.Event("hide.bs."+this.type);function i(){"in"!=a.hoverState&&n.detach(),a.$element.removeAttr("aria-describedby").trigger("hidden.bs."+a.type),e&&e()}if(this.$element.trigger(o),!o.isDefaultPrevented())return n.removeClass("in"),t.support.transition&&n.hasClass("fade")?n.one("bsTransitionEnd",i).emulateTransitionEnd(r.TRANSITION_DURATION):i(),this.hoverState=null,this},r.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},r.prototype.hasContent=function(){return this.getTitle()},r.prototype.getPosition=function(e){var r=(e=e||this.$element)[0],a="BODY"==r.tagName,n=r.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var o=a?{top:0,left:0}:e.offset(),i={scroll:a?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},s=a?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,i,s,o)},r.prototype.getCalculatedOffset=function(t,e,r,a){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-r/2}:"top"==t?{top:e.top-a,left:e.left+e.width/2-r/2}:"left"==t?{top:e.top+e.height/2-a/2,left:e.left-r}:{top:e.top+e.height/2-a/2,left:e.left+e.width}},r.prototype.getViewportAdjustedDelta=function(t,e,r,a){var n={top:0,left:0};if(!this.$viewport)return n;var o=this.options.viewport&&this.options.viewport.padding||0,i=this.getPosition(this.$viewport);if(/right|left/.test(t)){var s=e.top-o-i.scroll,c=e.top+o-i.scroll+a;s<i.top?n.top=i.top-s:c>i.top+i.height&&(n.top=i.top+i.height-c)}else{var l=e.left-o,u=e.left+o+r;l<i.left?n.left=i.left-l:u>i.right&&(n.left=i.left+i.width-u)}return n},r.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},r.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},r.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},r.prototype.enable=function(){this.enabled=!0},r.prototype.disable=function(){this.enabled=!1},r.prototype.toggleEnabled=function(){this.enabled=!this.enabled},r.prototype.toggle=function(e){var r=this;e&&((r=t(e.currentTarget).data("bs."+this.type))||(r=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,r))),e?(r.inState.click=!r.inState.click,r.isInStateTrue()?r.enter(r):r.leave(r)):r.tip().hasClass("in")?r.leave(r):r.enter(r)},r.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide((function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null}))};var a=t.fn.tooltip;t.fn.tooltip=function(a){return this.each((function(){var n=t(this),o=n.data("bs.tooltip"),i="object"==(void 0===a?"undefined":e(a))&&a;!o&&/destroy|hide/.test(a)||(o||n.data("bs.tooltip",o=new r(this,i)),"string"==typeof a&&o[a]())}))},t.fn.tooltip.Constructor=r,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=a,this}}(jQuery),function(t){var r=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");r.VERSION="3.3.5",r.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),(r.prototype=t.extend({},t.fn.tooltip.Constructor.prototype)).constructor=r,r.prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),r=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof r?"html":"append":"text"](r),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},r.prototype.hasContent=function(){return this.getTitle()||this.getContent()},r.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var a=t.fn.popover;t.fn.popover=function(a){return this.each((function(){var n=t(this),o=n.data("bs.popover"),i="object"==(void 0===a?"undefined":e(a))&&a;!o&&/destroy|hide/.test(a)||(o||n.data("bs.popover",o=new r(this,i)),"string"==typeof a&&o[a]())}))},t.fn.popover.Constructor=r,t.fn.popover.noConflict=function(){return t.fn.popover=a,this}}(jQuery)),MG.chart_title=X,MG.scale_factory=function(e){var r={use_inflator:!1,zero_bottom:!1,scaleType:"numerical"};return this.namespace=function(t){return r.namespace=t,r.namespace_accessor_name=r.namespace+"_accessor",r.scale_name=r.namespace.toUpperCase(),r.scalefn_name=r.namespace+"f",this},this.scaleName=function(t){return r.scale_name=t.toUpperCase(),r.scalefn_name=t+"f",this},this.inflateDomain=function(t){return r.use_inflator=t,this},this.zeroBottom=function(t){return r.zero_bottom=t,this},this.numericalDomainFromData=function(){var a,n=[];arguments.length>0&&(n=arguments);for(var o=0;o<e.data.length;o++)e.data[o].length>0&&(a=e.data[o]);r.is_time_series=!!E(a[0][e[r.namespace_accessor_name]]),U(e,r.scalefn_name,r.scale_name,e[r.namespace_accessor_name]),B(e,r,n,r.use_inflator);var i=e.utc_time?t.scaleUtc():t.scaleTime();return e.scales[r.scale_name]=r.is_time_series?i:P(e[r.namespace+"_scale_type"])?e.y_scale_type():"log"===e[r.namespace+"_scale_type"]?t.scaleLog():t.scaleLinear(),e.scales[r.scale_name].domain([e.processed["min_"+r.namespace],e.processed["max_"+r.namespace]]),r.scaleType="numerical",this},this.categoricalDomain=function(a){return e.scales[r.scale_name]=t.scaleOrdinal().domain(a),U(e,r.scalefn_name,r.scale_name,e[r.namespace_accessor_name]),this},this.categoricalDomainFromData=function(){var a=D(e.data);return r.categoricalVariables=t.set(a.map((function(t){return t[e[r.namespace_accessor_name]]}))).values(),e.scales[r.scale_name]=t.scaleBand().domain(r.categoricalVariables),r.scaleType="categorical",this},this.numericalRange=function(t){return"string"==typeof t?e.scales[r.scale_name].range(N(t,e)):e.scales[r.scale_name].range(t),this},this.categoricalRangeBands=function(t,a){void 0===a&&(a=!1);var n=r.namespace,o=e[n+"_padding_percentage"],i=e[n+"_outer_padding_percentage"];return"string"==typeof t?e.scales[r.scale_name].range(N(t,e)).paddingInner(o).paddingOuter(i):e.scales[r.scale_name].range(t).paddingInner(o).paddingOuter(i),U(e,r.scalefn_name,r.scale_name,e[r.namespace_accessor_name],a?e.scales[r.scale_name].bandwidth()/2:0),this},this.categoricalRange=function(t){return e.scales[r.scale_name].range(t),U(e,r.scalefn_name,r.scale_name,e[r.namespace_accessor_name]),this},this.categoricalColorRange=function(){return e.scales[r.scale_name]=e.scales[r.scale_name].domain().length>10?t.scaleOrdinal(t.schemeCategory20):t.scaleOrdinal(t.schemeCategory10),e.scales[r.scale_name].domain(r.categoricalVariables),U(e,r.scalefn_name,r.scale_name,e[r.namespace_accessor_name]),this},this.clamp=function(t){return e.scales[r.scale_name].clamp(t),this},this};var K={};function J(t){if(t.y_rug){t.rug_buffer_size="point"===t.chart_type?t.buffer/2:2*t.buffer/3;var e=y(t,"mg-y-rug");e.attr("x1",t.left+1).attr("x2",t.left+t.rug_buffer_size).attr("y1",t.scalefns.yf).attr("y2",t.scalefns.yf),v(e,t,"mg-y-rug-mono")}}function tt(e){var r=e.yax_format;if(!r){var a=e.decimals;"count"===e.format?(e.processed.y_ticks.length>1&&(a=Math.max(0,-Math.floor(Math.log(Math.abs(e.processed.y_ticks[1]-e.processed.y_ticks[0]))/Math.LN10))),r=function(r){var n;return n=0!==a?t.format(",."+a+"f"):r<1e3?t.format(",.0f"):t.format(",.2s"),e.yax_units_append?n(r)+e.yax_units:e.yax_units+n(r)}):r=function(e){return t.format(".0%")(e)}}return r}function et(t){var e=A(t.target),r=t.scales.X.domain();if(0>=r[0]&&r[1]>=0){var a=t.scales.Y.range(),n=t.categorical_groups.length?t.scales.YGROUP(t.categorical_groups[t.categorical_groups.length-1]):t.scales.YGROUP();e.append("svg:line").attr("x1",t.scales.X(0)).attr("x2",t.scales.X(0)).attr("y1",a[0]+f(t)).attr("y2",a[a.length-1]+n).attr("stroke","black").attr("opacity",.2)}}function rt(t,e){e.y_label&&t.append("text").attr("class","label").attr("x",(function(){return-1*(f(e)+(l(e)-f(e))/2)})).attr("y",(function(){return e.left/2})).attr("dy","-1.2em").attr("text-anchor","middle").text((function(t){return e.y_label})).attr("transform",(function(t){return"rotate(-90)"}))}function at(t){t.processed||(t.processed={});var e=A(t.target);if(MG.call_hook("y_axis.process_min_max",t,t.processed.min_y,t.processed.max_y),h(e,".mg-y-axis"),!t.y_axis)return this;var r=x(e,"mg-y-axis");return rt(r,t),Fe(t,"y"),function(t,e){var r,a,n=e.processed.y_ticks.length;e.x_extended_ticks||e.y_extended_ticks||!n||(e.axes_not_compact&&"bar"!==e.chart_type?(r=e.height-e.bottom,a=e.top):n?(r=e.scales.Y(e.processed.y_ticks[0]).toFixed(2),a=e.scales.Y(e.processed.y_ticks[n-1]).toFixed(2)):(r=0,a=0),t.append("line").attr("x1",e.left).attr("x2",e.left).attr("y1",r).attr("y2",a))}(r,t),function(t,e){t.selectAll(".mg-yax-ticks").data(e.processed.y_ticks).enter().append("line").classed("mg-extended-yax-ticks",e.y_extended_ticks).attr("x1",e.left).attr("x2",(function(){return e.y_extended_ticks?e.width-e.right:e.left-e.yax_tick_length})).attr("y1",(function(t){return e.scales.Y(t).toFixed(2)})).attr("y2",(function(t){return e.scales.Y(t).toFixed(2)}))}(r,t),function(t,e){var r=tt(e);t.selectAll(".mg-yax-labels").data(e.processed.y_ticks).enter().append("text").attr("x",e.left-3*e.yax_tick_length/2).attr("dx",-3).attr("y",(function(t){return e.scales.Y(t).toFixed(2)})).attr("dy",".35em").attr("text-anchor","end").text((function(t){return r(t)}))}(r,t),t.y_rug&&J(t),this}function nt(t){var e=A(t.target);h(e,".mg-y-axis");var r,a=x(e,"mg-y-axis");(t.categorical_groups.length?t.categorical_groups:["1"]).forEach((function(e){(r=x(a,"mg-group-"+z(e)),null!==t.ygroup_accessor)?function(t,e,r){t.append("svg:text").classed("mg-barplot-group-label",!0).attr("x",r.left-r.buffer).attr("y",r.scales.YGROUP(e)+r.scales.YGROUP.bandwidth()/2).attr("dy",".35em").attr("text-anchor","end").text(e)}(r,e,t):b(function(t,e,r){return t.selectAll("text").data(r.scales.Y.domain()).enter().append("svg:text").attr("x",r.left-r.buffer).attr("y",(function(t){return r.scales.YGROUP(e)+r.scales.Y(t)+r.scales.Y.bandwidth()/2})).attr("dy",".35em").attr("text-anchor","end").text(String)}(r,e,t),t.rotate_y_labels)}))}function ot(t){if(t.x_rug){t.rug_buffer_size="point"===t.chart_type?t.buffer/2:t.buffer;var e=y(t,"mg-x-rug");e.attr("x1",t.scalefns.xf).attr("x2",t.scalefns.xf).attr("y1",t.height-t.bottom-t.rug_buffer_size).attr("y2",t.height-t.bottom),v(e,t,"mg-x-rug-mono")}}function it(e){var r=A(e.target);if(function(t){t.processed||(t.processed={})}(e),function(t){var e=t.chart_type;t.processed.xax_format||(t.xax_format?t.processed.xax_format=t.xax_format:"line"===e||"point"===e||"histogram"===e?t.processed.xax_format=xt(t):"bar"===e&&(t.processed.xax_format=lt(t)))}(e),h(r,".mg-x-axis"),!e.x_axis)return this;var a=x(r,"mg-x-axis");return function(t,e){Fe(e,"x"),function(t,e){var r=t.scales.X.ticks(t.xax_count).length-1;t.x_extended_ticks||e.append("line").attr("x1",(function(){return 0===t.xax_count?p(t):t.axes_not_compact&&"bar"!==t.chart_type?t.left:t.scales.X(t.scales.X.ticks(t.xax_count)[0]).toFixed(2)})).attr("x2",(function(){return 0===t.xax_count||t.axes_not_compact&&"bar"!==t.chart_type?_(t):t.scales.X(t.scales.X.ticks(t.xax_count)[r]).toFixed(2)})).attr("y1",t.height-t.bottom).attr("y2",t.height-t.bottom)}(e,t),function(t,e){e.selectAll(".mg-xax-ticks").data(t.processed.x_ticks).enter().append("line").attr("x1",(function(e){return t.scales.X(e).toFixed(2)})).attr("x2",(function(e){return t.scales.X(e).toFixed(2)})).attr("y1",t.height-t.bottom).attr("y2",(function(){return t.x_extended_ticks?t.top:t.height-t.bottom+t.xax_tick_length})).attr("class",(function(){if(t.x_extended_ticks)return"mg-extended-xax-ticks"})).classed("mg-xax-ticks",!0)}(e,t)}(a,e),function(e,r){(function(e,r){var a=r.selectAll(".mg-xax-labels").data(e.processed.x_ticks).enter().append("text").attr("x",(function(t){return e.scales.X(t).toFixed(2)})).attr("y",(e.height-e.bottom+7*e.xax_tick_length/3).toFixed(2)).attr("dy",".50em").attr("text-anchor","middle");e.time_series&&e.european_clock?(a.append("tspan").classed("mg-european-hours",!0).text((function(e,r){var a=new Date(e);return 0===r?t.timeFormat("%H")(a):""})),a.append("tspan").classed("mg-european-minutes-seconds",!0).text((function(t,r){var a=new Date(t);return":"+e.processed.xax_format(a)}))):a.text((function(t){return e.xax_units+e.processed.xax_format(t)}));if(w(a)){a.filter((function(t,e){return(e+1)%2==0})).remove(),A(e.target).selectAll(".mg-xax-ticks").filter((function(t,e){return(e+1)%2==0})).remove()}})(r,e),function(e,r){e.time_series&&(e.show_years||e.show_secondary_x_label)&&function(e,r){var a=yt(e),n=a.secondary(e.processed.min_x,e.processed.max_x);if(0===n.length){n=[e.scales.X.ticks(e.xax_count)[0]]}var o=x(r,"mg-year-marker");"default"===a.timeframe&&e.show_year_markers&&function(t,e,r,a){e.selectAll(".mg-year-marker").data(r).enter().append("line").attr("x1",(function(e){return t.scales.X(e).toFixed(2)})).attr("x2",(function(e){return t.scales.X(e).toFixed(2)})).attr("y1",u(t)).attr("y2",c(t))}(e,o,n,a.yformat);"years"!=a.tick_diff_time_frame&&function(e,r,a,n){r.selectAll(".mg-year-marker").data(a).enter().append("text").attr("x",(function(t,r){return e.scales.X(t).toFixed(2)})).attr("y",(function(){var r=t.select(e.target).select(".mg-x-axis text").node().getBoundingClientRect();return c(e)+7*e.xax_tick_length/3+.8*r.height})).attr("dy",".50em").attr("text-anchor","middle").text((function(t){return n(new Date(t))}))}(e,o,n,a.yformat)}(e,r)}(r,e)}(a,e),e.x_label&&ct(a,e),e.x_rug&&ot(e),this}function I(e){var r;return null===e.color_domain?"number"===e.color_type?r=t.extent(e.data[0],(function(t){return t[e.color_accessor]})):"category"===e.color_type&&(r=t.set(e.data[0].map((function(t){return t[e.color_accessor]}))).values()).sort():r=e.color_domain,r}function H(t){return null===t.color_range?"number"===t.color_type?["blue","red"]:null:t.color_range}function st(t){return null===t.size_range?[1,5]:t.size_range}function ct(e,r){r.x_label&&e.append("text").attr("class","label").attr("x",(function(){return p(r)+(m(r)-p(r))/2})).attr("dx",null!=r.x_label_nudge_x?r.x_label_nudge_x:0).attr("y",(function(){var e=t.select(r.target).select(".mg-x-axis text").node().getBoundingClientRect();return c(r)+r.xax_tick_length*(7/3)+.8*e.height+10})).attr("dy",".5em").attr("text-anchor","middle").text((function(t){return r.x_label}))}function lt(e){return function(r){if(r<1&&r>-1&&0!==r)return e.xax_units+r.toFixed(e.decimals);var a=t.format(",.0f");return e.xax_units+a(r)}}function ut(t){return ft(t)?"millis":dt(t)?"seconds":pt(t)?"less-than-a-day":_t(t)?"four-days":mt(t)?"many-days":gt(t)?"many-months":function(t){return t/86400>=365}(t)?"years":"default"}function ft(t){return t<1}function dt(t){return t<60}function pt(t){return t/3600<24}function _t(t){return t/3600<96}function mt(t){return t/86400<60}function gt(t){return t/86400<365}function ht(t){if(t.time_series){var e=(t.processed.max_x-t.processed.min_x)/1e3,r=(t.processed.x_ticks[1]-t.processed.x_ticks[0])/1e3;t.processed.x_time_frame=ut(e),t.processed.x_tick_diff_time_frame=ut(r),t.processed.main_x_time_format=function(t,e){return ft(e)?MG.time_format(t,"%M:%S.%L"):dt(e)?MG.time_format(t,"%M:%S"):pt(e)?MG.time_format(t,"%H:%M"):_t(e)||mt(e)?MG.time_format(t,"%b %d"):gt(e)?MG.time_format(t,"%b"):MG.time_format(t,"%Y")}(t.utc_time,r)}}function xt(e){if(e.xax_format)return e.xax_format;var r=D(e.processed.original_data||e.data)[0],a=r[e.processed.original_x_accessor||e.x_accessor];return void 0===a&&(a=r),function(r){return ht(e),E(a)?e.processed.main_x_time_format(new Date(r)):"number"==typeof a?(n=r%1!=0?t.format(",."+e.decimals+"f"):r<1e3?t.format(",.0f"):t.format(",.2s"),e.xax_units+n(r)):e.xax_units+r;var n}}function yt(e){var r={timeframe:e.processed.x_time_frame,tick_diff_timeframe:e.processed.x_tick_diff_time_frame};switch(r.timeframe){case"millis":case"seconds":r.secondary=t.timeDays,e.european_clock?r.yformat=MG.time_format(e.utc_time,"%b %d"):r.yformat=MG.time_format(e.utc_time,"%I %p");break;case"less-than-a-day":case"four-days":r.secondary=t.timeDays,r.yformat=MG.time_format(e.utc_time,"%b %d");break;case"many-days":case"many-months":r.secondary=t.timeYears,r.yformat=MG.time_format(e.utc_time,"%Y");break;default:r.secondary=t.timeYears,r.yformat=MG.time_format(e.utc_time,"%Y")}return r}function vt(t){return t||(t={}),t.processed||(t.processed={}),t=R(t,{target:null,title:null,description:null})}function bt(t){var e=D(t.processed.original_data||t.data)[0];t.time_series=E(e[t.processed.original_x_accessor||t.x_accessor])}function wt(t){var e=parseInt(t.width);t.full_width&&(e=C(t.target)),"categorical"===t.x_axis_type&&null===e&&(e=Et(t,"x")),t.width=e}function kt(t){var e=parseInt(t.height);t.full_height&&(e=F(t.target,"height")),"categorical"===t.y_axis_type&&null===e&&(e=Et(t,"y")),t.height=e}function Mt(t,e){(!t.selectAll(".mg-main-line").empty()&&"line"!==e.chart_type||!t.selectAll(".mg-points").empty()&&"point"!==e.chart_type||!t.selectAll(".mg-histogram").empty()&&"histogram"!==e.chart_type||!t.selectAll(".mg-barplot").empty()&&"bar"!==e.chart_type)&&t.remove()}function Gt(e,r){return A(r.target).empty()&&(e=t.select(r.target).append("svg").classed("linked",r.linked).attr("width",r.width).attr("height",r.height)),e}function At(t,e){t.selectAll(".mg-clip-path").remove(),t.append("defs").attr("class","mg-clip-path").append("clipPath").attr("id","mg-plot-window-"+O(e.target)).append("svg:rect").attr("x",d(e)).attr("y",u(e)).attr("width",e.width-e.left-e.right-e.buffer).attr("height",e.height-e.top-e.bottom-e.buffer+1)}function Dt(t,e){e.width!==Number(t.attr("width"))&&t.attr("width",e.width),e.height!==Number(t.attr("height"))&&t.attr("height",e.height)}function Ot(t,e){t.attr("viewBox","0 0 "+e.width+" "+e.height),(e.full_width||e.full_height)&&t.attr("preserveAspectRatio","xMinYMin meet")}function zt(t){t.classed("mg-missing",!1),t.selectAll(".mg-missing-text").remove(),t.selectAll(".mg-missing-pane").remove()}function Ft(t,e){var r=0;if(t.selectAll(".mg-main-line").nodes().length>=e.data.length)if(e.custom_line_color_map.length>0){var a=S(function(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=r+1;return e}(e.max_data_size),e.custom_line_color_map);for(r=0;r<a.length;r++)t.selectAll(".mg-main-line.mg-line"+a[r]+"-color").remove()}else{var n=e.data.length;for(r=t.selectAll(".mg-main-line").nodes()?t.selectAll(".mg-main-line").nodes().length:0;r>n;r--)t.selectAll(".mg-main-line.mg-line"+r+"-color").remove()}}function Ct(t,e){t.empty()&&console.warn('The specified target element "'+e.target+'" could not be found in the page. The chart will not be rendered.')}function Tt(e,r){var a="x"===r?e.width:e.height;!function(e,r){var a=e[r+"group_accessor"];if(e.categorical_groups=[],a){var n=e.data[0];e.categorical_groups=t.set(n.map((function(t){return t[a]}))).values()}}(e,r),function(e,r){var a=e[r+"group_accessor"];if(e.total_bars=e.data[0].length,a){var n=function(t){return t.reduce((function(t,e){return t[e]=t[e]+1||1,t}),{})}((o=e.data[0],i=a,o.map((function(t){return t[i]}))));n=t.max(Object.keys(n).map((function(t){return n[t]}))),e.bars_per_group=n}else e.bars_per_group=e.data[0].length;var o,i}(e,r),function(t,e,r){var a=e+"group_height";if(r){var n="y"===e?(t.height-t.top-t.bottom-2*t.buffer)/(t.categorical_groups.length||1):(t.width-t.left-t.right-2*t.buffer)/(t.categorical_groups.length||1);t[a]=n}else{var o=(1+t[e+"_padding_percentage"])*t.bar_thickness;t[a]=t.bars_per_group*o+2*t[e+"_outer_padding_percentage"]*o}}(e,r,a),a&&function(t,e){var r=t[e+"group_height"]/(t.bars_per_group+t[e+"_outer_padding_percentage"]);t.bar_thickness=r-r*t[e+"_padding_percentage"]}(e,r)}function Rt(t){var e=t.chart_type;t.processed.xax_format||(t.xax_format?t.processed.xax_format=t.xax_format:"line"===e||"point"===e||"histogram"===e?t.processed.xax_format=xt(t):"bar"===e&&(t.processed.xax_format=lt(t)))}function Et(t,e){return t[e+"group_height"]*(t.categorical_groups.length||1)+("y"===e?t.top+t.bottom+2*t.buffer:t.left+t.right+2*t.buffer)+t.categorical_groups.length*t[e+"group_height"]*(t[e+"group_padding_percentage"]+t[e+"group_outer_padding_percentage"])}function Yt(e){e=vt(e=arguments[0]);var r=t.select(e.target);Ct(r,e);var a=r.selectAll("svg");return"categorical"===e.y_axis_type&&Tt(e,"y"),"categorical"===e.x_axis_type&&Tt(e,"x"),Rt(e),bt(e),wt(e),kt(e),Mt(a,e),At(a=Gt(a,e),e),Dt(a,e),Ot(a,e),zt(a),X(e),Ft(a,e),this}function $t(t){return t.label}function Pt(t){return function(e){return t.scales.X(e[t.x_accessor])>=p(t)&&t.scales.X(e[t.x_accessor])<=m(t)}}function St(t){return function(e){return t.scales.X(e[t.x_accessor])}}function Lt(t){var e=t.scales.Y;return function(t){return e(t.value).toFixed(2)}}function jt(t,e,r,a,n,o){var i;t&&(n(i=a.append("g").attr("class",e),r),o(i,r))}function Xt(t,e){var r=function(t){var e=St(t);return function(t){return e(t).toFixed(2)}}(e);t.selectAll(".mg-markers").data(e.markers.filter(Pt(e))).enter().append("line").attr("x1",r).attr("x2",r).attr("y1",e.top).attr("y2",l(e)).attr("class",(function(t){return t.lineclass})).attr("stroke-dasharray","3,1")}function Ut(e,r){e.selectAll(".mg-markers").data(r.markers.filter(Pt(r))).enter().append("text").attr("class",(function(t){return t.textclass||""})).classed("mg-marker-text",!0).attr("x",St(r)).attr("y","bottom"===r.x_axis_position?.95*u(r):c(r)+r.buffer).attr("text-anchor","middle").text($t).each((function(e){e.click&&t.select(this).style("cursor","pointer").on("click",e.click),e.mouseover&&t.select(this).style("cursor","pointer").on("mouseover",e.mouseover),e.mouseout&&t.select(this).style("cursor","pointer").on("mouseout",e.mouseout)})),function(e,r){if(e&&1!=e.length)for(var a=0;a<e.length;a++)if(M(e[a],e)){var n=t.select(e[a]),o=+n.attr("y");o+8>=r.top&&(o=r.top-16),n.attr("y",o)}}(e.selectAll(".mg-marker-text").nodes(),r)}function Nt(t,e){var r=Lt(e);t.selectAll(".mg-baselines").data(e.baselines).enter().append("line").attr("x1",p(e)).attr("x2",m(e)).attr("y1",r).attr("y2",r)}function Bt(t,e){var r=Lt(e);t.selectAll(".mg-baselines").data(e.baselines).enter().append("text").attr("x",m(e)).attr("y",r).attr("dy",-3).attr("text-anchor","end").text($t)}function It(t){var e=A(t.target);return function(t){t.selectAll(".mg-markers").remove(),t.selectAll(".mg-baselines").remove()}(e),function(t,e){jt(t.markers,"mg-markers",t,e,Xt,Ut)}(t,e),function(t,e){jt(t.baselines,"mg-baselines",t,e,Nt,Bt)}(t,e),this}function Ht(t){t.selectAll(".mg-active-datapoint-container").selectAll("*").remove()}function qt(e,r){e.select(".mg-active-datapoint").remove();var a,n="right"===r.mouseover_align?"end":"left"===r.mouseover_align?"start":"middle",o="right"===r.mouseover_align?m(r):"left"===r.mouseover_align?p(r):(r.width-r.left-r.right)/2+r.left,i=e.select(".mg-active-datapoint-container").append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("text-anchor",n),s=.75,l="bottom"===r.x_axis_position?u(r)*s:c(r)+3*r.buffer;r.markers&&e.selectAll(".mg-marker-text").each((function(){a?a!==t.select(this).attr("y")&&(s=.56):a=t.select(this).attr("y")}));i.attr("transform","translate("+o+","+l+")")}function Vt(t,e){qt(e.svg,t);var r,a,n={row_number:0,rargs:e,mouseover_row:function(t){return n.row_number+=1,function(t,e,r){var a=e.append("tspan").attr("x",0).attr("y",1.1*t+"em");return{rargs:r,text:function(t){return e=t,{bold:function(){return r.attr("font-weight","bold")},font_size:function(t){return r.attr("font-size",t)},x:function(t){return r.attr("x",t)},y:function(t){return r.attr("y",t)},elem:r=a.append("tspan").text(e)};var e,r}}}(n.row_number,n.text_container,t)},text_container:(r=e.svg,a=r.select(".mg-active-datapoint"),a.selectAll("*").remove(),a)};return n}K.categorical=function(t,e){e.namespace;Z(t,e),function(t,e){var r,a,n,o,i=e.namespace,s=(t.scalefns[i+"f"],t.scalefns[i+"groupf"],t.scales[(i+"group").toUpperCase()]),c=t.scales[i.toUpperCase()],u=e.position,d=A(t.target),_=s.domain&&s.domain()?s.domain():[null];h(d,".mg-category-guides");var g=x(d,"mg-category-guides");_.forEach((function(e){c.domain().forEach((function(i){"left"!==u&&"right"!==u||(r=p(t),a=m(t),n=c(i)+s(e)+c.bandwidth()/2,o=c(i)+s(e)+c.bandwidth()/2),"top"!==u&&"bottom"!==u||(r=c(i)+s(e)+c.bandwidth()/2*(null===e),a=c(i)+s(e)+c.bandwidth()/2*(null===e),n=l(t),o=f(t)),g.append("line").attr("x1",r).attr("x2",a).attr("y1",n).attr("y2",o).attr("stroke-dasharray","2,1")}));var i,d,_,h,x,y,v,b,w=s(e)+c(c.domain()[0])+c.bandwidth()/2*(null===e||"top"!==u&&"bottom"!=u),k=s(e)+c(c.domain()[c.domain().length-1])+c.bandwidth()/2*(null===e||"top"!==u&&"bottom"!=u);"left"!==u&&"right"!==u||(i=p(t),d=p(t),_=w,h=k,x=m(t),y=m(t),v=w,b=k),"bottom"!==u&&"top"!==u||(i=w,d=k,_=l(t),h=l(t),x=w,y=k,v=f(t),b=f(t)),g.append("line").attr("x1",i).attr("x2",d).attr("y1",_).attr("y2",h).attr("stroke-dasharray","2,1"),g.append("line").attr("x1",x).attr("x2",y).attr("y1",v).attr("y2",b).attr("stroke-dasharray","2,1")}))}(t,e)},K.numerical=function(t,e){var r=e.namespace,a=r+"_axis",n="mg-"+r+"-axis",o=A(t.target);if(h(o,"."+n),!t[a])return this;var i=x(o,n);return function(t,e){var r=t[e+"_accessor"],a=t.scales[e.toUpperCase()].ticks(t[e+"ax_count"]),n=t.processed["max_"+e];function o(t){return 1e3===t?3:1e6===t?7:Math.log(t)/Math.LN10}"log"===t[e+"_scale_type"]&&(a=a.filter((function(t){return Math.abs(o(t))%1<1e-6||Math.abs(o(t))%1>.999999})));var i=a.length,s=!0;t.data.forEach((function(t,e){t.forEach((function(t,e){if(t[r]%1!=0)return s=!1,!1}))})),s&&i>n&&"count"===t.format&&(a=a.filter((function(t){return t%1==0}))),t.processed[e+"_ticks"]=a}(t,r),W(i,t,e),function(t,e,r){var a,n,o,i,s=r.namespace,l=r.position,f=e.scales[s.toUpperCase()],p=e.processed[s+"_ticks"],m="mg-"+s+"ax-ticks",g="mg-extended-"+s+"ax-ticks",h=e[s+"_extended_ticks"],x=e[s+"ax_tick_length"];"left"===l&&(a=d(e),n=h?_(e):d(e)-x,o=function(t){return f(t).toFixed(2)},i=function(t){return f(t).toFixed(2)}),"right"===l&&(a=_(e),n=h?d(e):_(e)+x,o=function(t){return f(t).toFixed(2)},i=function(t){return f(t).toFixed(2)}),"top"===l&&(a=function(t){return f(t).toFixed(2)},n=function(t){return f(t).toFixed(2)},o=u(e),i=h?c(e):u(e)-x),"bottom"===l&&(a=function(t){return f(t).toFixed(2)},n=function(t){return f(t).toFixed(2)},o=c(e),i=h?u(e):c(e)+x),t.selectAll("."+m).data(p).enter().append("line").classed(g,h).attr("x1",a).attr("x2",n).attr("y1",o).attr("y2",i)}(i,t,e),V(i,t,e),t[r+"_label"]&&e.label(o.select(".mg-"+r+"-axis"),t),t[r+"_rug"]&&Q(t,e),t.show_bar_zero&&et(t),this},MG.axis_factory=function(t){var e={type:"numerical"};return this.namespace=function(t){return e.namespace=t,this},this.rug=function(t){return e.rug=t,this},this.label=function(t){return e.label=t,this},this.type=function(t){return e.type=t,this},this.position=function(t){return e.position=t,this},this.zeroLine=function(t){return e.zeroLine=t,this},this.draw=function(){return K[e.type](t,e),this},this},MG.y_rug=J,MG.y_axis=at,MG.y_axis_categorical=function(t){return t.y_axis?(nt(t),t.show_bar_zero&&et(t),t.ygroup_accessor&&function(t){var e=A(t.target),r=t.scales.YGROUP.domain();r[0],r[r.length-1],e.select(".mg-category-guides").selectAll("mg-group-lines").data(r).enter().append("line").attr("x1",p(t)).attr("x2",p(t)).attr("y1",(function(e){return t.scales.YGROUP(e)})).attr("y2",(function(e){return t.scales.YGROUP(e)+t.ygroup_height})).attr("stroke-width",1)}(t),t.y_categorical_show_guides&&function(t){var e=A(t.target),r=[];t.data[0].forEach((function(a){-1===r.indexOf(a[t.y_accessor])&&e.select(".mg-category-guides").append("line").attr("x1",p(t)).attr("x2",m(t)).attr("y1",t.scalefns.yf(a)+t.scalefns.ygroupf(a)).attr("y2",t.scalefns.yf(a)+t.scalefns.ygroupf(a)).attr("stroke-dasharray","2,1")}))}(t),this):this},MG.x_rug=ot,MG.x_axis=it,MG.x_axis_categorical=function(t){var e=A(t.target),r=0;"bar"===t.chart_type&&(r=t.buffer+5),mg_add_categorical_scale(t,"X",t.categorical_variables.reverse(),t.left,m(t)-r),U(t,"xf","X","value"),h(e,".mg-x-axis");var a=x(e,"mg-x-axis");return t.x_axis?(function(t,e,r){var a=t.selectAll("text").data(e.categorical_variables).enter().append("text");a.attr("x",(function(t){return e.scales.X(t)+e.scales.X.bandwidth()/2+e.buffer*e.bar_outer_padding_percentage+r/2})).attr("y",l(e)).attr("dy",".35em").attr("text-anchor","middle").text(String),e.truncate_x_labels&&a.each((function(t,r){j(this,t,e.scales.X.bandwidth())}));b(a,e.rotate_x_labels)}(a,t,r),this):this},MG.init=Yt,MG.markers=It;var Wt=function(t,e){return function(r){return["x","y"].every((function(a){return!(a in e)||function(t,e){return t>Math.min(e[0],e[1])&&t<Math.max(e[0],e[1])}(r[t[a+"_accessor"]],e[a])}))}},Qt=function(t,e){var r=t.processed.raw_data||t.data;"raw_data"in t.processed||(t.processed.raw_domain={x:t.scales.X.domain(),y:t.scales.Y.domain()},t.processed.raw_data=r),"point"===t.chart_type&&(o(r)?t.data=r.map((function(r){return r.filter(Wt(t,e))})):t.data=r.filter(Wt(t,e))),["x","y"].forEach((function(r){r in e?t.processed["zoom_"+r]=e[r]:delete t.processed["zoom_"+r]})),t.processed.subplot&&(e!==t.processed.raw_domain?MG.create_brushing_pattern(t.processed.subplot,Kt(t.processed.subplot,e)):MG.remove_brushing_pattern(t.processed.subplot)),new MG.charts[t.chart_type||defaults.chart_type].descriptor(t)},Zt=function(t,e){return["x","y"].reduce((function(r,a){return a in e?(r[a]=e[a].map((function(e){return+t.scales[a.toUpperCase()].invert(e)})),"y"===a&&r[a].reverse(),r):r}),{})},Kt=function(t,e){return["x","y"].reduce((function(r,a){return a in e?(r[a]=e[a].map((function(e){return+t.scales[a.toUpperCase()](e)})),"y"===a&&r[a].reverse(),r):r}),{})};MG.convert_range_to_domain=Zt,MG.zoom_to_data_domain=Qt,MG.zoom_to_data_range=function(t,e){var r=Zt(t,e);Qt(t,r)},MG.zoom_to_raw_range=function(t){"raw_domain"in t.processed&&(Qt(t,t.processed.raw_domain),delete t.processed.raw_domain,delete t.processed.raw_data)};var Jt=function(e){return t.select(e.target).select(".mg-extent").size()?t.select(e.target).select(".mg-extent"):t.select(e.target).select(".mg-rollover-rect, .mg-voronoi").insert("g","*").classed("mg-brush",!0).append("rect").classed("mg-extent",!0)},te=function(t,e){var r=e.x[0],a=e.x[1]-e.x[0],n=e.y[0],o=e.y[1]-e.y[0];Jt(t).attr("x",r).attr("width",a).attr("y",n).attr("height",o).attr("opacity",1)},ee=function(t){Jt(t).attr("width",0).attr("height",0).attr("opacity",0)};MG.add_brush_function=function(e){if("categorical"===e.x_axis_type||"categorical"===e.y_axis_type)return console.warn('The option "brush" does not support axis type "categorical" currently.');e.zoom_target||(e.zoom_target=e),e.zoom_target!==e&&(e.zoom_target.processed.subplot=e);var r=void 0;switch(e.brush){case"x":r={x:!0,y:!1};break;case"y":r={x:!1,y:!0};break;case"xy":r={x:!0,y:!0};break;default:r={x:!0,y:!0}}!function(e,r,a){var n=t.select(e.target).select("svg"),o=n.select(".mg-rollover-rect, .mg-voronoi"),i=o.node(),s=!1,c=!1,l=[],u=function(){var r=e.left,n=e.width-e.right-e.buffer,o=e.top,s=e.height-e.bottom-e.buffer,c=t.mouse(i),u={};return u.x=a.x?[Math.max(r,Math.min(l[0],c[0])),Math.min(n,Math.max(l[0],c[0]))]:[r,n],u.y=a.y?[Math.max(o,Math.min(l[1],c[1])),Math.min(s,Math.max(l[1],c[1]))]:[o,s],u};o.classed("mg-brush-container",!0),o.on("mousedown."+e.target,(function(){c=!0,s=!1,l=t.mouse(i),n.classed("mg-brushed",!1),n.classed("mg-brushing-in-progress",!0),ee(e)})),t.select(document).on("mousemove."+e.target,(function(){c&&(s=!0,o.classed("mg-brushing",!0),te(e,u()))})),t.select(document).on("mouseup."+e.target,(function(){if(c){c=!1,n.classed("mg-brushing-in-progress",!1);var t=u();if(s)if(s=!1,r===e)MG.zoom_to_data_range(r,t),n.select(".mg-rollover-rect, .mg-voronoi").classed("mg-brushed",!0);else{var a=MG.convert_range_to_domain(e,t);MG.zoom_to_data_domain(r,a)}else MG.zoom_to_raw_range(r);P(e.brushing_selection_changed)&&e.brushing_selection_changed(e,t)}}))}(e,e.zoom_target,r)},MG.create_brushing_pattern=te,MG.remove_brushing_pattern=ee;var re=new function(){var e,r=[];function a(){r.forEach((function(e){var r=t.select(e).select("svg");if(!r.empty()&&(r.node().parentNode.offsetWidth>0||r.node().parentNode.offsetHeight>0)){var a=0!==r.attr("width")?r.attr("height")/r.attr("width"):0,n=C(e);r.attr("width",n),r.attr("height",a*n)}}))}return"undefined"!=typeof MutationObserver?e=MutationObserver:"undefined"!=typeof WebKitMutationObserver&&(e=WebKitMutationObserver),{add_target:function(n){if(0===r.length&&window.addEventListener("resize",a,!0),-1===r.indexOf(n)&&(r.push(n),e)){var o=new e((function(e){var i=t.select(n).node();i&&!e.some((function(t){for(var e=0;e<t.removedNodes.length;e++)if(t.removedNodes[e]===i)return!0}))||(o.disconnect(),function(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1),0===r.length&&window.removeEventListener("resize",a,!0)}(n))}));o.observe(t.select(n).node().parentNode,{childList:!0})}}}};function ae(t){!function(t){(t.full_width||t.full_height)&&re.add_target(t.target)}(t)}r()&&function(t){if("function"==typeof t().dropdown)return!0;var e='[data-toggle="dropdown"]',r=function(e){t(e).on("click.bs.dropdown",this.toggle)};function a(r){r&&3===r.which||(t(".dropdown-backdrop").remove(),t(e).each((function(){var e=t(this),a=n(e),o={relatedTarget:this};a.hasClass("open")&&(a.trigger(r=t.Event("hide.bs.dropdown",o)),r.isDefaultPrevented()||(e.attr("aria-expanded","false"),a.removeClass("open").trigger("hidden.bs.dropdown",o)))})))}function n(e){var r=e.attr("data-target");r||(r=(r=e.attr("href"))&&/#[A-Za-z]/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,""));var a=r&&t(r);return a&&a.length?a:e.parent()}r.VERSION="3.3.1",r.prototype.toggle=function(e){var r=t(this);if(!r.is(".disabled, :disabled")){var o=n(r),i=o.hasClass("open");if(a(),!i){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",a);var s={relatedTarget:this};if(o.trigger(e=t.Event("show.bs.dropdown",s)),e.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},r.prototype.keydown=function(r){if(/(38|40|27|32)/.test(r.which)&&!/input|textarea/i.test(r.target.tagName)){var a=t(this);if(r.preventDefault(),r.stopPropagation(),!a.is(".disabled, :disabled")){var o=n(a),i=o.hasClass("open");if(!i&&27!=r.which||i&&27==r.which)return 27==r.which&&o.find(e).trigger("focus"),a.trigger("click");var s=" li:not(.divider):visible a",c=o.find('[role="menu"]'+s+', [role="listbox"]'+s);if(c.length){var l=c.index(r.target);38==r.which&&l>0&&l--,40==r.which&&l<c.length-1&&l++,~l||(l=0),c.eq(l).trigger("focus")}}}};var o=t.fn.dropdown;t.fn.dropdown=function(e){return this.each((function(){var a=t(this),n=a.data("bs.dropdown");n||a.data("bs.dropdown",n=new r(this)),"string"==typeof e&&n[e].call(a)}))},t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=o,this},t(document).on("click.bs.dropdown.data-api",a).on("click.bs.dropdown.data-api",".dropdown form",(function(t){t.stopPropagation()})).on("click.bs.dropdown.data-api",e,r.prototype.toggle).on("keydown.bs.dropdown.data-api",e,r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',r.prototype.keydown)}(jQuery),MG.button_layout=function(t){return this.target=t,this.feature_set={},this.public_name={},this.sorters={},this.manual=[],this.manual_map={},this.manual_callback={},this._strip_punctuation=function(t){return t.replace(/[^a-zA-Z0-9 _]+/g,"").replace(/ +?/g,"")},this.data=function(t){return this._data=t,this},this.manual_button=function(t,e,r){return this.feature_set[t]=e,this.manual_map[this._strip_punctuation(t)]=t,this.manual_callback[t]=r,this},this.button=function(t){return arguments.length>1&&(this.public_name[t]=arguments[1]),arguments.length>2&&(this.sorters[t]=arguments[2]),this.feature_set[t]=[],this},this.callback=function(t){return this._callback=t,this},this.display=function(){var t,e,r,a,n=this._callback,o=this.manual_callback,i=this.manual_map;r=Object.keys(this.feature_set);var s,c=function(e){return t[e]};for(s=0;s<this._data.length;s++){t=this._data[s],e=r.map(c);for(var l=0;l<r.length;l++)a=r[l],-1===this.feature_set[a].indexOf(e[l])&&this.feature_set[a].push(e[l])}for(a in this.feature_set)this.sorters.hasOwnProperty(a)&&this.feature_set[a].sort(this.sorters[a]);$(this.target).empty(),$(this.target).append("<div class='col-lg-12 segments text-center'></div>");var u=function(){var t,e=$(this).data("key"),r=$(this).data("feature");return $("."+r+"-btns button.btn span.title").html(e),i.hasOwnProperty(r)?(t=i[r],o[t](e)):n(r,e),!1};for(var f in this.feature_set){for(r=this.feature_set[f],$(this.target+" div.segments").append('<div class="btn-group '+this._strip_punctuation(f)+'-btns text-left"><button type="button" class="btn btn-default btn-lg dropdown-toggle" data-toggle="dropdown"><span class=\'which-button\'>'+(this.public_name.hasOwnProperty(f)?this.public_name[f]:f)+"</span><span class='title'>"+(this.manual_callback.hasOwnProperty(f)?this.feature_set[f][0]:"all")+'</span><span class="caret"></span></button><ul class="dropdown-menu" role="menu">'+(this.manual_callback.hasOwnProperty(f)?"":'<li><a href="#" data-feature="'+f+'" data-key="all">All</a></li>')+(this.manual_callback.hasOwnProperty(f)?"":'<li class="divider"></li>')+"</ul></div>"),s=0;s<r.length;s++)"all"!==r[s]&&void 0!==r[s]&&$(this.target+" div."+this._strip_punctuation(f)+"-btns ul.dropdown-menu").append('<li><a href="#" data-feature="'+this._strip_punctuation(f)+'" data-key="'+r[s]+'">'+r[s]+"</a></li>");$("."+this._strip_punctuation(f)+"-btns .dropdown-menu li a").on("click",u)}return this},this};var ne=function(t,e,r){var a=e.line_id,n=r.color,o=r.colors;t.classed("mg-hover-line-color",null===n).classed("mg-hover-line"+a+"-color",null===o).attr("fill",null===o?"":o[a-1])},oe=function(e,r,a){r.existing_band=a.selectAll(".mg-confidence-band").nodes(),e.show_confidence_band&&(r.confidence_area=t.area().defined(r.line.defined()).x(e.scalefns.xf).y0((function(t){var r=e.show_confidence_band[0];return null!=t[r]?e.scales.Y(t[r]):e.scales.Y(t[e.y_accessor])})).y1((function(t){var r=e.show_confidence_band[1];return null!=t[r]?e.scales.Y(t[r]):e.scales.Y(t[e.y_accessor])})).curve(e.interpolate))},ie=function(e,r){var a=e.scalefns,n=e.scales,o=e.interpolate,i=e.flip_area_under_y_value,s=Number.isFinite(i)?n.Y(i):n.Y.range()[0];r.area=t.area().defined(r.line.defined()).x(a.xf).y0((function(){return s})).y1(a.yf).curve(o)},se=function(e,r){var a=e.y_accessor,n=e.scalefns,o=e.scales,i=e.interpolate;r.flat_line=t.line().defined((function(t){return(void 0===t._missing||!0!==t._missing)&&null!==t[a]})).x(n.xf).y((function(){return o.Y(r.data_median)})).curve(i)},ce=function(e,r){var a=e.scalefns,n=e.interpolate,o=e.missing_is_zero,i=e.y_accessor;r.line=t.line().x(a.xf).y(a.yf).curve(n),o||(r.line=r.line.defined((function(t){return(void 0===t._missing||!0!==t._missing)&&null!==t[i]})))},le=function(t,e,r,a){var n=t.show_confidence_band,o=t.transition_on_update,i=t.data,s=t.target;if(n){r.select(".mg-confidence-band-"+a).empty()&&r.append("path").attr("class","mg-confidence-band mg-confidence-band-"+a),r.select(".mg-confidence-band-"+a).transition().duration((function(){return o?1e3:0})).attr("d",e.confidence_area(i[a-1])).attr("clip-path","url(#mg-plot-window-"+O(s)+")")}},ue=function(t,e,r,a,n){var o=t.data,i=t.target,s=t.colors,c=r.selectAll(".mg-main-area.mg-area"+n);e.display_area?c.empty()?r.append("path").classed("mg-main-area",!0).classed("mg-area"+n,!0).classed("mg-area-color",null===s).classed("mg-area"+n+"-color",null===s).attr("d",e.area(o[a])).attr("fill",null===s?"":s[n-1]).attr("clip-path","url(#mg-plot-window-"+O(i)+")"):(r.node().appendChild(c.node()),c.transition().duration(e.update_transition_duration).attr("d",e.area(o[a])).attr("clip-path","url(#mg-plot-window-"+O(i)+")")):c.empty()||c.remove()},fe=function(t,e){t.classed("mg-line-color",!0).classed("mg-line"+e+"-color",!0)},de=function(e,r,a,n,o,i){if(n.empty()){var s=a.append("path").attr("class","mg-main-line mg-line"+i);!function(t,e,r,a){var n=t.colors;n&&n.constructor===Array?(e.attr("stroke",n[r]),n.length<r+1&&fe(e,a)):fe(e,a)}(e,s,o,i),function(e,r,a,n){var o=e.animate_on_load,i=e.data,s=e.y_accessor,c=e.target;o?(r.data_median=t.median(i[n],(function(t){return t[s]})),a.attr("d",r.flat_line(i[n])).transition().duration(1e3).attr("d",r.line(i[n])).attr("clip-path","url(#mg-plot-window-"+O(c)+")")):a.attr("d",r.line(i[n])).attr("clip-path","url(#mg-plot-window-"+O(c)+")")}(e,r,s,o)}else{a.node().appendChild(n.node());var c=n.transition().duration(r.update_transition_duration);r.display_area||!e.transition_on_update||e.missing_is_hidden?c.attr("d",r.line(e.data[o])):c.attrTween("d",Ve(r.line(e.data[o]),4))}},pe=function(e,r,a,o){var i,s=void 0;if(e.legend)if(n(e.legend)?s=e.legend[a]:(i=e.legend,"[object Function]"===Object.prototype.toString.call(i)&&(s=e.legend(e.data[a]))),e.legend_target)e.colors&&e.colors.constructor===Array?r.legend_text="<span style='color:"+e.colors[a]+"'>&mdash; "+s+"&nbsp; </span>"+r.legend_text:r.legend_text="<span class='mg-line"+o+"-legend-color'>&mdash; "+s+"&nbsp; </span>"+r.legend_text;else{var c=void 0,l=void 0,u=void 0;"left"===e.y_axis_position?(c=e.data[a][e.data[a].length-1],l="start",u=e.buffer):(c=e.data[a][0],l="end",u=-e.buffer);var f=r.legend_group.append("svg:text").attr("x",e.scalefns.xf(c)).attr("dx",u).attr("y",e.scalefns.yf(c)).attr("dy",".35em").attr("font-size",10).attr("text-anchor",l).attr("font-weight","300").text(s);e.colors&&e.colors.constructor===Array?e.colors.length<a+1?f.classed("mg-line"+o+"-legend-color",!0):f.attr("fill",e.colors[a]):f.classed("mg-line-legend-color",!0).classed("mg-line"+o+"-legend-color",!0),function(e,r){if(e&&1!=e.length){var a,n,o;e.sort((function(e,r){return t.select(r).attr("y")-t.select(e).attr("y")})),e.reverse();for(var i=0;i<e.length;i++){n=t.select(e[i]).text();for(var s=0;s<e.length;s++)if(o=t.select(e[s]).text(),!1!==(a=k(e[i],e[s]))&&n!==o){var c=t.select(e[i]),l=+c.attr("y");l+=a,c.attr("y",l)}}}}(r.legend_group.selectAll(".mg-line-legend text").nodes())}},_e=function(e,r,a,n,o,i){var s,c,l=t.voronoi().x((function(t){return e.scales.X(t[e.x_accessor]).toFixed(2)})).y((function(t){return e.scales.Y(t[e.y_accessor]).toFixed(2)})).extent([[e.buffer,e.buffer+(e.title?e.title_y_position:0)],[e.width-e.buffer,e.height-e.buffer]]);x(r,"mg-voronoi").selectAll("path").data(l.polygons((s=e,c=s.data,t.merge(c)))).enter().append("path").filter((function(t){return void 0!==t&&t.length>0})).attr("d",(function(t){return null==t?null:"M"+t.join("L")+"Z"})).datum((function(t){return null==t?null:t.data})).attr("class",function(t){return function(e){var r=void 0;if(t.linked){var a=e[t.x_accessor],n=MG.time_format(t.utc_time,t.linked_format);return r="roll_"+("number"==typeof a?e.line_id-1:n(a))+" mg-line"+e.line_id,null===t.color&&(r+=" mg-line"+e.line_id+"-color"),r}return r="mg-line"+e.line_id,null===t.color&&(r+=" mg-line"+e.line_id+"-color"),r}}(e)).on("click",i).on("mouseover",a).on("mouseout",n).on("mousemove",o),ge(e,r)},me=function(e,r,a,n,o,i){var s=function(e){var r=e.x_accessor,a=e.data,n=e.x_sort,o=t.nest().key((function(t){return t[r]})).entries(t.merge(a));return o.forEach((function(t){var e=t.values[0];t.key=e[r]})),n?o.sort((function(t,e){return new Date(t.key)-new Date(e.key)})):o}(e),c=s.map((function(t){var r=t.key;return e.scales.X(r)}));r.append("g").attr("class","mg-rollover-rect").selectAll(".mg-rollover-rects").data(s).enter().append("rect").attr("x",(function(t,r){return 1===c.length?p(e):0===r?c[r].toFixed(2):((c[r-1]+c[r])/2).toFixed(2)})).attr("y",e.top).attr("width",(function(t,r){return 1===c.length?m(e):0===r?((c[r+1]-c[r])/2).toFixed(2):r===c.length-1?((c[r]-c[r-1])/2).toFixed(2):((c[r+1]-c[r-1])/2).toFixed(2)})).attr("class",(function(t){var r=t.values,a=r.map((function(t){var r=t.line_id,a=he(r);return null===e.colors&&(a+=" "+xe(r)),a})).join(" ");return e.linked&&r.length>0&&(a+=" "+ye(ve(r[0],e))),a})).attr("height",e.height-e.bottom-e.top-e.buffer).attr("opacity",0).on("click",i).on("mouseover",a).on("mouseout",n).on("mousemove",o),be(e,r)},ge=function(t,e){for(var r=t.data,a=t.custom_line_color_map,n=0;n<r.length;n++){var o=n+1;a.length>0&&void 0!==a[n]&&(o=a[n]),1!==r[n].length||e.selectAll(".mg-voronoi .mg-line"+o).empty()||(e.selectAll(".mg-voronoi .mg-line"+o).on("mouseover")(r[n][0],0),e.selectAll(".mg-voronoi .mg-line"+o).on("mouseout")(r[n][0],0))}},he=function(t){return"mg-line"+t},xe=function(t){return"mg-line"+t+"-color"},ye=function(t){return"roll_"+t},ve=function(t,e){var r=e.x_accessor,a=e.utc_time,n=e.linked_format,o=t[r],i=MG.time_format(a,n);return"number"==typeof o?o.toString().replace(".","_"):i(o)},be=function(t,e){var r=t.data,a=e.selectAll(".mg-rollover-rect rect"),n=a.nodes()[0][0]||a.nodes()[0];r.filter((function(t){return 1===t.length})).length>0&&a.on("mouseover")(n.__data__,0)},we=function(t){var e=t.data;return 1===e.length&&1===e[0].length},ke=function(t,e){var r=t.existing_band;r[0]&&r[0].length>e.selectAll(".mg-main-line").node().length&&e.selectAll(".mg-confidence-band").remove()},Me=function(e){var r,a,n={},o=A(e.target);h(o,".mg-line-legend"),function(t,e,r){t.legend&&(e.legend_group=x(r,"mg-line-legend"))}(e,n,o),n.data_median=0,n.update_transition_duration=e.transition_on_update?1e3:0,n.display_area=e.area&&!e.use_data_y_min&&e.data.length<=1&&!1===e.aggregate_rollover||Array.isArray(e.area)&&e.area.length>0,n.legend_text="",function(t,e,r){ce(t,e),ie(t,e),se(t,e),oe(t,e,r)}(e,n,o),n.existing_band=o.selectAll(".mg-confidence-band").nodes(),!1!==MG.call_hook("line.before_all_series",[e])&&function(t,e,r){ke(e,r),t.active_point_on_lines&&r.selectAll("circle.mg-shown-active-point").remove();for(var a=t.data.length-1;a>=0;a--){var n=t.data[a];MG.call_hook("line.before_each_series",[n,t]);var o=a+1;if(t.custom_line_color_map.length>0&&(o=t.custom_line_color_map[a]),t.data[a].line_id=o,t.active_point_on_lines&&r.selectAll("circle-"+o).data(t.data[a]).enter().filter((function(e){return e[t.active_point_accessor]})).append("circle").attr("class","mg-area"+o+"-color mg-shown-active-point").attr("cx",t.scalefns.xf).attr("cy",t.scalefns.yf).attr("r",(function(){return t.active_point_size})),0!==n.length){var i=r.select("path.mg-main-line.mg-line"+o);le(t,e,r,o),Array.isArray(t.area)?t.area[o-1]&&ue(t,e,r,a,o):ue(t,e,r,a,o),de(t,e,r,i,a,o),pe(t,e,a,o),MG.call_hook("line.after_each_series",[n,i,t])}}}(e,n,o),r=e.legend_target,a=n.legend_text,r&&t.select(r).html(a)},Ge=function(t,e){var r,a,n,o=A(t.target);t.showActivePoint&&0===o.selectAll(".mg-active-datapoint-container").nodes().length&&x(o,"mg-active-datapoint-container"),function(t){h(t,".mg-rollover-rect"),h(t,".mg-voronoi"),h(t,".mg-active-datapoint"),h(t,".mg-line-rollover-circle")}(o),function(t,e){var r=t.data,a=t.colors,n=e.selectAll(".mg-line-rollover-circle").data(r).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",0);a&&a.constructor===Array?n.attr("class",(function(t){return"mg-line"+t.line_id})).attr("fill",(function(t,e){return a[e]})).attr("stroke",(function(t,e){return a[e]})):n.attr("class",(function(t,e){var r=t.line_id;return["mg-line"+r,"mg-line"+r+"-color","mg-area"+r+"-color"].join(" ")})),n.classed("mg-line-rollover-circle",!0)}(t,o),function(t){for(var e=t.data,r=t.custom_line_color_map,a=0;a<e.length;a++)for(var n=0;n<e[a].length;n++)e[a][n].index=a+1,r.length>0?e[a][n].line_id=r[a]:e[a][n].line_id=a+1}(t),a=(r=t).data,n=r.aggregate_rollover,a.length>1&&!n?_e(t,o,e.rolloverOn(t),e.rolloverOff(t),e.rolloverMove(t),e.rolloverClick(t)):function(t){var e=t.data,r=t.aggregate_rollover;return e.length>1&&r}(t)?me(t,o,e.rolloverOn(t),e.rolloverOff(t),e.rolloverMove(t),e.rolloverClick(t)):function(t,e,r,a,n,o){var i=1;t.custom_line_color_map.length>0&&(i=t.custom_line_color_map[0]);var s=e.append("g").attr("class","mg-rollover-rect"),c=t.data[0].map(t.scalefns.xf);s.selectAll(".mg-rollover-rects").data(t.data[0]).enter().append("rect").attr("class",(function(e,r){var a=xe(i)+" "+he(e.line_id);return t.linked&&(a+=a+" "+ye(ve(e,t))),a})).attr("x",(function(e,r){return 1===c.length?p(t):0===r?c[r].toFixed(2):((c[r-1]+c[r])/2).toFixed(2)})).attr("y",(function(e,r){return t.data.length>1?t.scalefns.yf(e)-6:t.top})).attr("width",(function(e,r){return 1===c.length?m(t):0===r?((c[r+1]-c[r])/2).toFixed(2):r===c.length-1?((c[r]-c[r-1])/2).toFixed(2):((c[r+1]-c[r-1])/2).toFixed(2)})).attr("height",(function(e,r){return t.data.length>1?12:t.height-t.bottom-t.top-t.buffer})).attr("opacity",0).on("click",o).on("mouseover",r).on("mouseout",a).on("mousemove",n),we(t)&&function(t,e){var r=t.data;e.select(".mg-rollover-rect rect").on("mouseover")(r[0][0],0)}(t,e)}(t,o,e.rolloverOn(t),e.rolloverOff(t),e.rolloverMove(t),e.rolloverClick(t))},Ae=function(t,e,r){var a=t.scales,n=t.x_accessor,o=t.y_accessor,i=t.point_size;e.select("circle.mg-line-rollover-circle.mg-line"+r.line_id).attr("cx",a.X(r[n]).toFixed(2)).attr("cy",a.Y(r[o]).toFixed(2)).attr("r",i).style("opacity",1)},De=function(t,e,r){var a=t.scales,n=t.x_accessor,o=t.y_accessor,i=t.point_size;e.selectAll("circle.mg-line-rollover-circle.mg-line"+r.line_id).classed("mg-line-rollover-circle",!0).attr("cx",(function(){return a.X(r[n]).toFixed(2)})).attr("cy",(function(){return a.Y(r[o]).toFixed(2)})).attr("r",i).style("opacity",1)};MG.register("line",(function(e){this.init=function(t){if(this.args=t,!t.data||0===t.data.length)return t.internal_error="No data was supplied",function(t){console.error("INTERNAL ERROR : ",t.target," : ",t.internal_error)}(t),this;t.internal_error=void 0,Ce(t),Re(t),MG.call_hook("line.before_destroy",this),Yt(t),new MG.scale_factory(t).namespace("x").numericalDomainFromData().numericalRange("bottom");var e=(t.baselines||[]).map((function(e){return e[t.y_accessor]}));return new MG.scale_factory(t).namespace("y").zeroBottom(!0).inflateDomain(!0).numericalDomainFromData(e).numericalRange("left"),t.x_axis&&new MG.axis_factory(t).namespace("x").type("numerical").position(t.x_axis_position).rug(ot(t)).label(ct).draw(),t.y_axis&&new MG.axis_factory(t).namespace("y").type("numerical").position(t.y_axis_position).rug(J(t)).label(rt).draw(),this.markers(),this.mainPlot(),this.rollover(),this.windowListeners(),t.brush&&MG.add_brush_function(t),MG.call_hook("line.after_init",this),this},this.mainPlot=function(){return Me(e),this},this.markers=function(){return It(e),this},this.rollover=function(){return Ge(e,this),MG.call_hook("line.after_rollover",e),this},this.rolloverClick=function(t){return function(e,r){t.click&&t.click(e,r)}},this.rolloverOn=function(e){var r=A(e.target);return function(n,o){if(function(t,e,r){if(t.aggregate_rollover&&t.data.length>1)e.selectAll("circle.mg-line-rollover-circle").style("opacity",0),r.values.forEach((function(r,n,o){t.missing_is_hidden&&o[n]._missing||a(r,t)&&Ae(t,e,r)}));else{if(t.missing_is_hidden&&r._missing||null===r[t.y_accessor])return;a(r,t)&&De(t,e,r)}}(e,r,n),function(e,r,a){if(e.linked&&!MG.globals.link&&(MG.globals.link=!0,!e.aggregate_rollover||void 0!==r[e.y_accessor]||r.values&&r.values.length>0)){var n=r.values?r.values[0]:r,o=ve(n,e);t.selectAll("."+he(n.line_id)+"."+ye(o)).each((function(e){t.select(this).on("mouseover")(e,a)}))}}(e,n,o),r.selectAll("text").filter((function(t,e){return n===t})).attr("opacity",.3),e.show_rollover_text&&!(e.missing_is_hidden&&n._missing||null===n[e.y_accessor])){var i=Vt(e,{svg:r}),s=i.mouseover_row();e.aggregate_rollover&&s.text((e.aggregate_rollover&&e.data.length>1?qe:Ie)(e,n)),(e.aggregate_rollover&&e.data.length>1?n.values:[n]).forEach((function(t){e.aggregate_rollover&&(s=i.mouseover_row()),e.legend&&ne(s.text(e.legend[t.index-1]+"  ").bold(),t,e),ne(s.text("‚Äî  ").elem,t,e),e.aggregate_rollover||s.text(Ie(e,t)),s.text(He(e,t,e.time_series))}))}e.mouseover&&e.mouseover(n,o)}},this.rolloverOff=function(e){var r=A(e.target);return function(a,n){!function(e,r,a){var n=e.linked,o=e.utc_time,i=e.linked_format,s=e.x_accessor;if(n&&MG.globals.link){MG.globals.link=!1;var c=MG.time_format(o,i);(r.values?r.values:[r]).forEach((function(e){var r=e[s],n="number"==typeof r?a:c(r);t.selectAll(".roll_"+n).each((function(e){t.select(this).on("mouseout")(e)}))}))}}(e,a,n),e.aggregate_rollover?function(t,e){e.selectAll("circle.mg-line-rollover-circle").filter((function(t){return t.length>1})).style("opacity",0)}(0,r):function(t,e,r){var a=t.custom_line_color_map,n=t.data,o=r.line_id;e.selectAll("circle.mg-line-rollover-circle.mg-line"+o).style("opacity",(function(){var t=o-1;return a.length>0&&void 0!==a.indexOf(o)&&(t=a.indexOf(o)),1===n[t].length?1:0}))}(e,r,a),e.data[0].length>1&&Ht(r),e.mouseout&&e.mouseout(a,n)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.windowListeners=function(){return ae(this.args),this},this.init(e)}));function Oe(t,e,r){var a=Vt(t,{svg:e}).mouseover_row();if(null!==t.color_accessor&&"category"===t.color_type){var n=r[t.color_accessor];a.text(n+"  ").bold().attr("fill",t.scalefns.colorf(r))}!function(t,e,r){var a=t.color_accessor,n=t.scalefns;null!==a?(e.attr("fill",n.colorf(r)),e.attr("stroke",n.colorf(r))):e.classed("mg-points-mono",!0)}(t,a.text("‚óè   ").elem,r),a.text(Ie(t,r)),a.text(He(t,r,t.time_series))}MG.register("histogram",(function(e){var r=this;this.init=function(t){r.args=t,Ce(t),Ee(t),Yt(t),new MG.scale_factory(t).namespace("x").numericalDomainFromData().numericalRange("bottom");var e=(t.baselines||[]).map((function(e){return e[t.y_accessor]}));return new MG.scale_factory(t).namespace("y").zeroBottom(!0).inflateDomain(!0).numericalDomainFromData(e).numericalRange("left"),it(t),at(t),r.mainPlot(),r.markers(),r.rollover(),r.windowListeners(),r},this.mainPlot=function(){var t=A(e.target);return t.selectAll(".mg-histogram").remove(),t.append("g").attr("class","mg-histogram").selectAll(".mg-bar").data(e.data[0]).enter().append("g").attr("class","mg-bar").attr("transform",(function(t){return"translate("+e.scales.X(t[e.x_accessor]).toFixed(2)+","+e.scales.Y(t[e.y_accessor]).toFixed(2)+")"})).append("rect").attr("x",1).attr("width",(function(t,r){return 1===e.data[0].length?(e.scalefns.xf(e.data[0][0])-e.bar_margin).toFixed(0):r!==e.data[0].length-1?(e.scalefns.xf(e.data[0][r+1])-e.scalefns.xf(t)).toFixed(0):(e.scalefns.xf(e.data[0][1])-e.scalefns.xf(e.data[0][0])).toFixed(0)})).attr("height",(function(t){return 0===t[e.y_accessor]?0:(e.height-e.bottom-e.buffer-e.scales.Y(t[e.y_accessor])).toFixed(2)})),r},this.markers=function(){return It(e),r},this.rollover=function(){var t=A(e.target);return 0===t.selectAll(".mg-active-datapoint-container").nodes().length&&x(t,"mg-active-datapoint-container"),t.selectAll(".mg-rollover-rect").remove(),t.selectAll(".mg-active-datapoint").remove(),t.append("g").attr("class","mg-rollover-rect").selectAll(".mg-bar").data(e.data[0]).enter().append("g").attr("class",(function(t,r){return e.linked?"mg-rollover-rects roll_"+r:"mg-rollover-rects"})).attr("transform",(function(t){return"translate("+e.scales.X(t[e.x_accessor])+",0)"})).append("rect").attr("x",1).attr("y",e.buffer+(e.title?e.title_y_position:0)).attr("width",(function(t,r){return 1===e.data[0].length?(e.scalefns.xf(e.data[0][0])-e.bar_margin).toFixed(0):r!==e.data[0].length-1?(e.scalefns.xf(e.data[0][r+1])-e.scalefns.xf(t)).toFixed(0):(e.scalefns.xf(e.data[0][1])-e.scalefns.xf(e.data[0][0])).toFixed(0)})).attr("height",(function(t){return e.height})).attr("opacity",0).on("mouseover",r.rolloverOn(e)).on("mouseout",r.rolloverOff(e)).on("mousemove",r.rolloverMove(e)),r},this.rolloverOn=function(e){var r=A(e.target);return function(a,n){r.selectAll("text").filter((function(t,e){return a===t})).attr("opacity",.3);e.processed.xax_format||MG.time_format(e.utc_time,"%b %e, %Y"),Xe(e);if(r.selectAll(".mg-bar rect").filter((function(t,e){return e===n})).classed("active",!0),e.linked&&!MG.globals.link&&(MG.globals.link=!0,t.selectAll(".mg-rollover-rects.roll_"+n+" rect").each((function(e){t.select(this).on("mouseover")(e,n)}))),e.show_rollover_text){var o=Vt(e,{svg:r}).mouseover_row();o.text("‚ñü  ").elem.classed("hist-symbol",!0),o.text(Ie(e,a)),o.text(He(e,a,e.time_series))}e.mouseover&&(qt(r,e),e.mouseover(a,n))}},this.rolloverOff=function(e){var r=A(e.target);return function(a,n){e.linked&&MG.globals.link&&(MG.globals.link=!1,t.selectAll(".mg-rollover-rects.roll_"+n+" rect").each((function(e){t.select(this).on("mouseout")(e,n)}))),r.selectAll(".mg-bar rect").classed("active",!1),Ht(r),e.mouseout&&e.mouseout(a,n)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.windowListeners=function(){return ae(r.args),r},this.init(e)}),{binned:!1,bins:null,processed_x_accessor:"x",processed_y_accessor:"y",processed_dx_accessor:"dx",bar_margin:1});var ze=function(t,e){var r=e.x_accessor,a=e.y_accessor;return t.filter((function(t){return(null===e.min_x||t[r]>=e.min_x)&&(null===e.max_x||t[r]<=e.max_x)&&(null===e.min_y||t[a]>=e.min_y)&&(null===e.max_y||t[a]<=e.max_y)}))};MG.register("point",(function(e){var r=this;this.init=function(t){this.args=t,t.x_axis_type=G(t,"x"),t.y_axis_type=G(t,"y"),Ce(t),Ye(t),Yt(t);if("categorical"===t.x_axis_type?(MG.scale_factory(t).namespace("x").categoricalDomainFromData().categoricalRangeBands([0,t.xgroup_height],null===t.xgroup_accessor),t.xgroup_accessor?new MG.scale_factory(t).namespace("xgroup").categoricalDomainFromData().categoricalRangeBands("bottom"):(t.scales.XGROUP=function(){return p(t)},t.scalefns.xgroupf=function(){return p(t)}),t.scalefns.xoutf=function(e){return t.scalefns.xf(e)+t.scalefns.xgroupf(e)}):(MG.scale_factory(t).namespace("x").inflateDomain(!0).zeroBottom("categorical"===t.y_axis_type).numericalDomainFromData((t.baselines||[]).map((function(e){return e[t.x_accessor]}))).numericalRange("bottom"),t.scalefns.xoutf=t.scalefns.xf),"categorical"===t.y_axis_type)MG.scale_factory(t).namespace("y").zeroBottom(!0).categoricalDomainFromData().categoricalRangeBands([0,t.ygroup_height],!0),t.ygroup_accessor?new MG.scale_factory(t).namespace("ygroup").categoricalDomainFromData().categoricalRangeBands("left"):(t.scales.YGROUP=function(){return f(t)},t.scalefns.ygroupf=function(){return f(t)}),t.scalefns.youtf=function(e){return t.scalefns.yf(e)+t.scalefns.ygroupf(e)};else{var e=(t.baselines||[]).map((function(e){return e[t.y_accessor]}));MG.scale_factory(t).namespace("y").inflateDomain(!0).zeroBottom("categorical"===t.x_axis_type).numericalDomainFromData(e).numericalRange("left"),t.scalefns.youtf=function(e){return t.scalefns.yf(e)}}if(null!==t.color_accessor){var r=MG.scale_factory(t).namespace("color");"number"===t.color_type?r.numericalDomainFromData(I(t)).numericalRange(H(t)).clamp(!0):t.color_domain?r.categoricalDomain(t.color_domain).categoricalRange(t.color_range):r.categoricalDomainFromData().categoricalColorRange()}return t.size_accessor&&new MG.scale_factory(t).namespace("size").numericalDomainFromData().numericalRange(st(t)).clamp(!0),new MG.axis_factory(t).namespace("x").type(t.x_axis_type).zeroLine("categorical"===t.y_axis_type).position(t.x_axis_position).rug(ot(t)).label(ct).draw(),new MG.axis_factory(t).namespace("y").type(t.y_axis_type).zeroLine("categorical"===t.x_axis_type).position(t.y_axis_position).rug(J(t)).label(rt).draw(),this.mainPlot(),this.markers(),this.rollover(),this.windowListeners(),t.brush&&MG.add_brush_function(t),this},this.markers=function(){return It(e),e.least_squares&&$e(e),this},this.mainPlot=function(){var t=A(e.target),r=ze(e.data[0],e);t.selectAll(".mg-points").remove();var a=t.append("g").classed("mg-points",!0).selectAll("circle").data(r).enter().append("circle").attr("class",(function(t,e){return"path-"+e})).attr("cx",e.scalefns.xoutf).attr("cy",(function(t){return e.scalefns.youtf(t)}));return null!==e.color_accessor?(a.attr("fill",e.scalefns.colorf),a.attr("stroke",e.scalefns.colorf)):a.classed("mg-points-mono",!0),null!==e.size_accessor?a.attr("r",e.scalefns.sizef):a.attr("r",e.point_size),this},this.rollover=function(){var r=A(e.target);0===r.selectAll(".mg-active-datapoint-container").nodes().length&&x(r,"mg-active-datapoint-container"),r.selectAll(".mg-voronoi").remove();var a=t.voronoi().x(e.scalefns.xoutf).y(e.scalefns.youtf).extent([[e.buffer,e.buffer+(e.title?e.title_y_position:0)],[e.width-e.buffer,e.height-e.buffer]]);return r.append("g").attr("class","mg-voronoi").selectAll("path").data(a.polygons(ze(e.data[0],e))).enter().append("path").attr("d",(function(t){return null==t?null:"M"+t.join(",")+"Z"})).attr("class",(function(t,e){return"path-"+e})).style("fill-opacity",0).on("mouseover",this.rolloverOn(e)).on("mouseout",this.rolloverOff(e)).on("mousemove",this.rolloverMove(e)),1===e.data[0].length&&Oe(e,r,e.data[0][0]),this},this.rolloverOn=function(e){var a=A(e.target);return function(n,o){a.selectAll(".mg-points circle").classed("selected",!1);var i=a.selectAll(".mg-points circle.path-"+o).classed("selected",!0);e.size_accessor?i.attr("r",(function(t){return e.scalefns.sizef(t)+e.active_point_size_increase})):i.attr("r",e.point_size+e.active_point_size_increase),e.linked&&!MG.globals.link&&(MG.globals.link=!0,t.selectAll(".mg-voronoi .path-"+o).each((function(){t.select(r).on("mouseover")(n,o)}))),e.show_rollover_text&&Oe(e,a,n.data),e.mouseover&&e.mouseover(n,o)}},this.rolloverOff=function(e){var a=A(e.target);return function(n,o){e.linked&&MG.globals.link&&(MG.globals.link=!1,t.selectAll(".mg-voronoi .path-"+o).each((function(){t.select(r).on("mouseout")(n,o)})));var i=a.selectAll(".mg-points circle").classed("unselected",!1).classed("selected",!1);e.size_accessor?i.attr("r",e.scalefns.sizef):i.attr("r",e.point_size),e.data[0].length>1&&Ht(a),e.mouseout&&e.mouseout(n,o)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.update=function(t){return this},this.windowListeners=function(){return ae(this.args),this},this.init(e)}),{y_padding_percentage:.05,y_outer_padding_percentage:.2,ygroup_padding_percentage:0,ygroup_outer_padding_percentage:0,x_padding_percentage:.05,x_outer_padding_percentage:.2,xgroup_padding_percentage:0,xgroup_outer_padding_percentage:0,y_categorical_show_guides:!0,x_categorical_show_guides:!0,buffer:16,ls:!1,lowess:!1,point_size:2.5,label_accessor:null,size_accessor:null,color_accessor:null,size_range:null,color_range:null,size_domain:null,color_domain:null,active_point_size_increase:1,color_type:"number"});MG.register("bar",(function(e){var r=this;this.args=e,this.init=function(t){r.args=t,t.x_axis_type=G(t,"x"),t.y_axis_type=G(t,"y"),"categorical"==t.x_axis_type?t.orientation="vertical":"categorical"==t.y_axis_type?t.orientation="horizontal":"categorical"!=t.x_axis_type&&"categorical"!=t.y_axis_type&&(t.orientation="vertical"),Ce(t),Ye(t),Yt(t);if("categorical"===t.x_axis_type?(MG.scale_factory(t).namespace("x").categoricalDomainFromData().categoricalRangeBands([0,t.xgroup_height],null===t.xgroup_accessor),t.xgroup_accessor?new MG.scale_factory(t).namespace("xgroup").categoricalDomainFromData().categoricalRangeBands("bottom"):(t.scales.XGROUP=function(e){return p(t)},t.scalefns.xgroupf=function(e){return p(t)}),t.scalefns.xoutf=function(e){return t.scalefns.xf(e)+t.scalefns.xgroupf(e)}):(MG.scale_factory(t).namespace("x").inflateDomain(!0).zeroBottom("categorical"===t.y_axis_type).numericalDomainFromData((t.baselines||[]).map((function(e){return e[t.x_accessor]}))).numericalRange("bottom"),t.scalefns.xoutf=t.scalefns.xf),"categorical"===t.y_axis_type)MG.scale_factory(t).namespace("y").zeroBottom(!0).categoricalDomainFromData().categoricalRangeBands([0,t.ygroup_height],!0),t.ygroup_accessor?new MG.scale_factory(t).namespace("ygroup").categoricalDomainFromData().categoricalRangeBands("left"):(t.scales.YGROUP=function(){return f(t)},t.scalefns.ygroupf=function(e){return f(t)}),t.scalefns.youtf=function(e){return t.scalefns.yf(e)+t.scalefns.ygroupf(e)};else{var e=(t.baselines||[]).map((function(e){return e[t.y_accessor]}));MG.scale_factory(t).namespace("y").inflateDomain(!0).zeroBottom("categorical"===t.x_axis_type).numericalDomainFromData(e).numericalRange("left"),t.scalefns.youtf=function(e){return t.scalefns.yf(e)}}return null!==t.ygroup_accessor&&(t.ycolor_accessor=t.y_accessor,MG.scale_factory(t).namespace("ycolor").scaleName("color").categoricalDomainFromData().categoricalColorRange()),null!==t.xgroup_accessor&&(t.xcolor_accessor=t.x_accessor,MG.scale_factory(t).namespace("xcolor").scaleName("color").categoricalDomainFromData().categoricalColorRange()),new MG.axis_factory(t).namespace("x").type(t.x_axis_type).zeroLine("categorical"===t.y_axis_type).position(t.x_axis_position).draw(),new MG.axis_factory(t).namespace("y").type(t.y_axis_type).zeroLine("categorical"===t.x_axis_type).position(t.y_axis_position).draw(),r.mainPlot(),r.markers(),r.rollover(),r.windowListeners(),r},this.mainPlot=function(){var a=A(e.target),n=e.data[0],o=a.select("g.mg-barplot"),i=o.empty(),s=void 0;i&&e.animate_on_load||e.transition_on_update,e.transition_duration;i&&(o=a.append("g").classed("mg-barplot",!0)),s=o.selectAll(".mg-bar").data(n).enter().append("rect").classed("mg-bar",!0).classed("default-bar",!e.scales.hasOwnProperty("COLOR"));var c=void 0,l=void 0,u=void 0,f=void 0,d=void 0,p=void 0,_=void 0,g=void 0,h=void 0,x=void 0,y=void 0,v=void 0,b=void 0,w=void 0,k=void 0,M=void 0;if("vertical"==e.orientation&&(c="height",l="width",u=e.y_axis_type,f=e.x_axis_type,d="y",p="x",_="categorical"==u?e.scalefns.youtf:e.scalefns.yf,g="categorical"==f?e.scalefns.xoutf:e.scalefns.xf,h=e.scales.Y,x=e.scales.X,y=e.y_accessor,v=e.x_accessor,b=function(t){var e=void 0;return e=_(t),t[y]<0&&(e=h(0)),e},w=function(t){return Math.abs(_(t)-h(0))},k=function(t){return Math.abs(h(t[e.reference_accessor])-h(0))},M=function(t){return h(t[e.reference_accessor])}),"horizontal"==e.orientation&&(c="width",l="height",u=e.x_axis_type,f=e.y_axis_type,d="x",p="y",_="categorical"==u?e.scalefns.xoutf:e.scalefns.xf,g="categorical"==f?e.scalefns.youtf:e.scalefns.yf,h=e.scales.X,x=e.scales.Y,y=e.x_accessor,v=e.y_accessor,b=function(t){return h(0)},w=function(t){return Math.abs(_(t)-h(0))},k=function(t){return Math.abs(h(t[e.reference_accessor])-h(0))},M=function(t){return h(0)}),s.attr(d,b),s.attr(p,(function(t){var r=void 0;return"categorical"==f?r=g(t):(r=x(0),t[v]<0&&(r=g(t))),r-=e.bar_thickness/2})),e.scales.COLOR&&s.attr("fill",e.scalefns.colorf),s.attr(c,w).attr(l,(function(t){return e.bar_thickness})),null!==e.reference_accessor){var G=n.filter((function(t){return t.hasOwnProperty(e.reference_accessor)}));o.selectAll(".mg-categorical-reference").data(G).enter().append("rect").attr(d,M).attr(p,(function(t){return g(t)-e.reference_thickness/2})).attr(c,k).attr(l,e.reference_thickness)}if(null!==e.comparison_accessor){var D=null;D=null===e.comparison_thickness?e.bar_thickness/2:e.comparison_thickness;var O=n.filter((function(t){return t.hasOwnProperty(e.comparison_accessor)}));o.selectAll(".mg-categorical-comparison").data(O).enter().append("line").attr(d+"1",(function(t){return h(t[e.comparison_accessor])})).attr(d+"2",(function(t){return h(t[e.comparison_accessor])})).attr(p+"1",(function(t){return g(t)-D/2})).attr(p+"2",(function(t){return g(t)+D/2})).attr("stroke","black").attr("stroke-width",e.comparison_width)}return(e.legend||null!==e.color_accessor&&e.ygroup_accessor!==e.color_accessor)&&(e.legend_target?function(e){var r=e.legend_target,a=e.orientation,n=e.scales;if(r){var o=t.select(r).append("div").classed("mg-bar-target-legend",!0);("horizontal"==a?n.Y.domain():n.X.domain()).forEach((function(t){var e=o.append("span").classed("mg-bar-target-element",!0);e.append("span").classed("mg-bar-target-legend-shape",!0).style("color",n.COLOR(t)).text("‚óº "),e.append("span").classed("mg-bar-target-legend-text",!0).text(t)}))}}(e):function(t,e){var r=void 0;r="horizontal"==e.orientation?e.scales.Y.domain():e.scales.X.domain();var a=0,n=t.append("g").classed("mg-bar-legend",!0).append("text");n.selectAll("*").remove(),n.attr("width",e.right).attr("height",100).attr("text-anchor","start"),r.forEach((function(t){var r=n.append("tspan").attr("x",m(e)).attr("y",e.height/2).attr("dy",1.1*a+"em");r.append("tspan").text("‚ñ† ").attr("fill",e.scales.COLOR(t)).attr("font-size",20),r.append("tspan").text(t).attr("font-weight",300).attr("font-size",10),a++}))}(a,e)),r},this.markers=function(){return It(e),r},this.rollover=function(){var t=A(e.target);0===t.selectAll(".mg-active-datapoint-container").nodes().length&&x(t,"mg-active-datapoint-container"),t.selectAll(".mg-rollover-rect").remove(),t.selectAll(".mg-active-datapoint").remove();var a=void 0,n=void 0,o=void 0,i=void 0,s=void 0,c=void 0,l=void 0,u=void 0,d=void 0,p=void 0,_=void 0,m=void 0;"vertical"==e.orientation&&(a="height",n="width",o=e.y_axis_type,i=e.x_axis_type,s="y",c="x","categorical"==o?e.scalefns.youtf:e.scalefns.yf,l="categorical"==i?e.scalefns.xoutf:e.scalefns.xf,u=e.scales.Y,d=e.scales.X,e.y_accessor,p=e.x_accessor,_=function(t){return f(e)},m=function(t){return e.height-e.top-e.bottom-2*e.buffer}),"horizontal"==e.orientation&&(a="width",n="height",o=e.x_axis_type,i=e.y_axis_type,s="x",c="y","categorical"==o?e.scalefns.xoutf:e.scalefns.xf,l="categorical"==i?e.scalefns.youtf:e.scalefns.yf,u=e.scales.X,d=e.scales.Y,e.x_accessor,p=e.y_accessor,_=function(t){return u(0)},m=function(t){return e.width-e.left-e.right-2*e.buffer});var g=void 0,h=void 0;"right"===e.rollover_align?(g=e.width-e.right,h="end"):"left"===e.rollover_align?(g=e.left,h="start"):(g=(e.width-e.left-e.right)/2+e.left,h="middle"),t.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",g).attr("y",.75*e.top).attr("dy",".35em").attr("text-anchor",h);var y=t.append("g").attr("class","mg-rollover-rect").selectAll(".mg-bar-rollover").data(e.data[0]).enter().append("rect").attr("class","mg-bar-rollover");return y.attr("opacity",0).attr(s,_).attr(c,(function(t){var r=void 0;return"categorical"==i?r=l(t):(r=d(0),t[p]<0&&(r=l(t))),r-=e.bar_thickness/2})),y.attr(a,m),y.attr(n,(function(t){return e.bar_thickness})),y.on("mouseover",r.rolloverOn(e)).on("mouseout",r.rolloverOff(e)).on("mousemove",r.rolloverMove(e)),r},this.rolloverOn=function(e){var a=A(e.target);r.is_vertical?e.x_accessor:e.y_accessor,r.is_vertical?e.y_accessor:e.x_accessor,r.is_vertical?e.yax_units:e.xax_units;return function(r,n){MG.time_format(e.utc_time,"%b %e, %Y"),Xe(e);var o=a.selectAll("g.mg-barplot .mg-bar").filter((function(t,e){return e===n})).classed("active",!0);if(e.scales.hasOwnProperty("COLOR")?o.attr("fill",t.rgb(e.scalefns.colorf(r)).darker()):o.classed("default-active",!0),e.show_rollover_text){var i=Vt(e,{svg:a}),s=i.mouseover_row();e.ygroup_accessor&&s.text(r[e.ygroup_accessor]+"   ").bold(),s.text(Ie(e,r)),s.text(e.y_accessor+": "+r[e.y_accessor]),(e.predictor_accessor||e.baseline_accessor)&&(s=i.mouseover_row(),e.predictor_accessor&&s.text(Be(e,r,null,e.predictor_accessor,!1)),e.baseline_accessor&&s.text(Be(e,r,null,e.baseline_accessor,!1)))}e.mouseover&&e.mouseover(r,n)}},this.rolloverOff=function(t){var e=A(t.target);return function(r,a){var n=e.selectAll("g.mg-barplot .mg-bar.active").classed("active",!1);t.scales.hasOwnProperty("COLOR")?n.attr("fill",t.scalefns.colorf(r)):n.classed("default-active",!1),e.select(".mg-active-datapoint").text(""),Ht(e),t.mouseout&&t.mouseout(r,a)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.windowListeners=function(){return ae(r.args),r},this.init(e)}),{y_padding_percentage:.05,y_outer_padding_percentage:.2,ygroup_padding_percentage:0,ygroup_outer_padding_percentage:0,x_padding_percentage:.05,x_outer_padding_percentage:.2,xgroup_padding_percentage:0,xgroup_outer_padding_percentage:0,buffer:16,y_accessor:"factor",x_accessor:"value",reference_accessor:null,comparison_accessor:null,secondary_label_accessor:null,color_accessor:null,color_type:"category",color_domain:null,reference_thickness:1,comparison_width:3,comparison_thickness:null,legend:!1,legend_target:null,mouseover_align:"right",baseline_accessor:null,predictor_accessor:null,predictor_proportion:5,show_bar_zero:!0,binned:!0,truncate_x_labels:!0,truncate_y_labels:!0}),MG.data_table=function(e){return this.args=e,this.args.standard_col={width:150,font_size:12,font_weight:"normal"},this.args.columns=[],this.formatting_options=[["color","color"],["font-weight","font_weight"],["font-style","font_style"],["font-size","font_size"]],this._strip_punctuation=function(t){return t.replace(/[^a-zA-Z0-9 _]+/g,"").replace(/ +?/g,"")},this._format_element=function(t,e,r){this.formatting_options.forEach((function(a){var n=a[0],o=a[1];r[o]&&t.style(n,"string"==typeof r[o]||"number"==typeof r[o]?r[o]:r[o](e))}))},this._add_column=function(t,e){var r=this.args.standard_col,a=R(MG.clone(t),MG.clone(r));a.type=e,this.args.columns.push(a)},this.target=function(){var t=arguments[0];return this.args.target=t,this},this.title=function(){return this._add_column(arguments[0],"title"),this},this.text=function(){return this._add_column(arguments[0],"text"),this},this.bullet=function(){return this},this.sparkline=function(){return this},this.number=function(){return this._add_column(arguments[0],"number"),this},this.display=function(){var e=this.args;X(e);var a,n,o,i,s,c,l,u,f,d,p,_,m=e.target,g=t.select(m).append("table").classed("mg-data-table",!0),h=g.append("colgroup"),x=g.append("thead"),y=g.append("tbody");for(o=x.append("tr"),_=0;_<e.columns.length;_++){var v=e.columns[_];c=v.type,u=void 0===(u=v.label)?"":u,i=o.append("th").style("width",v.width).style("text-align","title"===c?"left":"right").text(u),e.show_tooltips&&v.description&&r()&&(i.append("i").classed("fa",!0).classed("fa-question-circle",!0).classed("fa-inverse",!0),$(i.node()).popover({html:!0,animation:!1,content:v.description,trigger:"hover",placement:"top",container:$(i.node())}))}for(_=0;_<e.columns.length;_++)p=h.append("col"),"number"===e.columns[_].type&&p.attr("align","char").attr("char",".");for(var b=0;b<e.data.length;b++){o=y.append("tr");for(var w=0;w<e.columns.length;w++){if(s=(a=e.columns[w]).accessor,l=f=e.data[b][s],"number"===(c=a.type)){if(a.hasOwnProperty("round")&&!a.hasOwnProperty("format")&&(f=t.format("0,."+a.round+"f")(f)),a.hasOwnProperty("value_formatter")&&(f=a.value_formatter(f)),a.hasOwnProperty("format")){a.round&&(f=Math.round(f,a.round));var k,M=a.format;"percentage"===M&&(k=t.format(".0%")),"count"===M&&(k=t.format(",.0f")),"temperature"===M&&(k=function(t){return t+"¬∞"}),f=k(f)}a.hasOwnProperty("currency")&&(f=a.currency+f)}d=o.append("td").classed("table-"+c,!0).classed("table-"+c+"-"+this._strip_punctuation(s),!0).attr("data-value",l).style("width",a.width).style("text-align","title"===c||"text"===c?"left":"right"),this._format_element(d,l,a),"title"===c?(n=d.append("div").text(f),this._format_element(n,f,a),e.columns[w].hasOwnProperty("secondary_accessor")&&d.append("div").text(e.data[b][e.columns[w].secondary_accessor]).classed("secondary-title",!0)):d.text(f)}}return this},this};function Fe(t,e){var r,a,n;function o(t){return 1e3===t?3:1e6===t?7:Math.log(t)/Math.LN10}"x"===e?(r=t.x_accessor,a=t.scales.X.ticks(t.xax_count),n=t.processed.max_x):"y"===e&&(r=t.y_accessor,a=t.scales.Y.ticks(t.yax_count),n=t.processed.max_y),("x"===e&&"log"===t.x_scale_type||"y"===e&&"log"===t.y_scale_type)&&(a=a.filter((function(t){return Math.abs(o(t))%1<1e-6||Math.abs(o(t))%1>.999999})));var i=a.length,s=!0;t.data.forEach((function(t,e){t.forEach((function(t,e){if(t[r]%1!=0)return s=!1,!1}))})),s&&i>n&&"count"===t.format&&(a=a.filter((function(t){return t%1==0}))),"x"===e?t.processed.x_ticks=a:"y"===e&&(t.processed.y_ticks=a)}function Ce(t){if(t.data=MG.clone(t.data),t.single_object=!1,t.array_of_objects=!1,t.array_of_arrays=!1,t.nested_array_of_arrays=!1,t.nested_array_of_objects=!1,o(t.data)?(t.nested_array_of_objects=t.data.map((function(t){return s(t)})),t.nested_array_of_arrays=t.data.map((function(t){return o(t)}))):(t.array_of_objects=i(t.data),t.array_of_arrays=o(t.data)),"line"===t.chart_type?(t.array_of_objects||t.array_of_arrays)&&(t.data=[t.data]):Y(t.data[0])||(t.data=[t.data]),function(t){Te(t,"x_accessor")}(t),function(t){Te(t,"y_accessor")}(t),void 0!==t.color&&(t.colors=t.color),null!==t.colors&&"string"==typeof t.colors&&(t.colors=[t.colors]),"line"===t.chart_type&&!0===t.x_sort)for(var e=0;e<t.data.length;e++)t.data[e].sort((function(e,r){return e[t.x_accessor]-r[t.x_accessor]}));return this}function Te(t,e){Y(t[e])&&(t.data=t.data.map((function(r){return t[e].map((function(t){return r.map((function(r){if(void 0!==(r=MG.clone(r))[t])return r["multiline_"+e]=r[t],r})).filter((function(t){return void 0!==t}))}))}))[0],t[e]="multiline_"+e)}function Re(e){var r,a=t.sum(e.data.map((function(t){return t.length>0&&E(t[0][e.x_accessor])})))>0;if((e.missing_is_zero||e.missing_is_hidden)&&"line"===e.chart_type&&a)for(var n=0;n<e.data.length;n++)if(!(e.data[n].length<=1)){var o=e.data[n][0],i=e.data[n][e.data[n].length-1],s=[],c=MG.clone(o[e.x_accessor]).setDate(o[e.x_accessor].getDate()+1),l=e.min_x?e.min_x:c,u=e.max_x?e.max_x:i[e.x_accessor];if(r=ut((u-l)/1e3),-1!==["four-days","many-days","many-months","years","default"].indexOf(r)&&null===e.missing_is_hidden_accessor)for(var f=new Date(l);f<=u;f.setDate(f.getDate()+1)){var d={};f.setHours(0,0,0,0),Date.parse(f)===Date.parse(new Date(c))&&s.push(MG.clone(e.data[n][0]));var p=null;e.data[n].forEach((function(t,r){if(Date.parse(t[e.x_accessor])===Date.parse(new Date(f)))return p=t,!1})),p?p[e.missing_is_hidden_accessor]||null===p[e.y_accessor]?(p._missing=!0,s.push(p)):s.push(p):(d[e.x_accessor]=new Date(f),d[e.y_accessor]=0,d._missing=!0,s.push(d))}else for(var _=0;_<e.data[n].length;_+=1){var m=MG.clone(e.data[n][_]);m._missing=e.data[n][_][e.missing_is_hidden_accessor],s.push(m)}e.data[n]=s}return this}function Ee(r){var a,n=r.data[0];if(!1===r.binned){if("object"===e(n[0]))a=n.map((function(t){return t[r.x_accessor]}));else{if("number"!=typeof n[0])return void console.log("TypeError: expected an array of numbers, found "+e(n[0]));a=n}var o=t.histogram();r.bins&&o.thresholds(r.bins);var i=o(a);r.processed_data=i.map((function(t){return{x:t.x0,y:t.length}}))}else{var s,c;r.processed_data=n.map((function(t){return{x:t[r.x_accessor],y:t[r.y_accessor]}}));for(var l=0;l<r.processed_data.length;l++)s=r.processed_data[l],l===r.processed_data.length-1?s.dx=r.processed_data[l-1].dx:(c=r.processed_data[l+1],s.dx=c.x-s.x)}return r.processed||(r.processed={}),r.processed.original_data=r.data,r.processed.original_x_accessor=r.x_accessor,r.processed.original_y_accessor=r.y_accessor,r.data=[r.processed_data],r.x_accessor=r.processed_x_accessor,r.y_accessor=r.processed_y_accessor,this}function Ye(t){var e=t.data[0],r=e.map((function(e){return e[t.x_accessor]})),a=e.map((function(e){return e[t.y_accessor]}));return t.least_squares&&(t.ls_line=Pe(r,a)),this}function $e(e){var r=A(e.target),a=e.data[0],n=t.min(a,(function(t){return t[e.x_accessor]})),o=t.max(a,(function(t){return t[e.x_accessor]}));t.select(e.target).selectAll(".mg-least-squares-line").remove(),r.append("svg:line").attr("x1",e.scales.X(n)).attr("x2",e.scales.X(o)).attr("y1",e.scales.Y(e.ls_line.fit(n))).attr("y2",e.scales.Y(e.ls_line.fit(o))).attr("class","mg-least-squares-line")}function Pe(e,r){var a,n,o;e.length;a=E(e[0])?e.map((function(t){return t.getTime()})):e,n=E(r[0])?r.map((function(t){return t.getTime()})):r;for(var i=t.mean(a),s=t.mean(n),c=0,l=0,u=0;u<a.length;u++)c+=((o=a[u])-i)*(n[u]-s),l+=(o-i)*(o-i);var f=c/l,d=s-f*i;return{x0:d,beta:f,fit:function(t){return d+t*f}}}function Se(t,e){return t>=0&&t<=1?Math.pow(1-Math.pow(t,e),e):0}function Le(e){var r,a,n=function(e){var r=t.sum(e.map((function(t){return t.w})));return{xbar:t.sum(e.map((function(t){return t.w*t.x})))/r,ybar:t.sum(e.map((function(t){return t.w*t.y})))/r}}(e),o=function(e,r,a){return t.sum(e.map((function(t){return Math.pow(t.w,2)*(t.x-r)*(t.y-a)})))/t.sum(e.map((function(t){return Math.pow(t.w,2)*Math.pow(t.x-r,2)})))}(e,a=n.xbar,r=n.ybar);return{beta:o,xbar:a,ybar:r,x0:r-o*a}}function je(e,r,a,n,o){var i=Math.floor(e.length*a),s=e.slice();s.sort((function(t,e){return t<e?-1:t>e?1:0}));for(var c,l,u,f,d,p=t.quantile(s,.98),_=t.quantile(s,.02),m=t.zip(e,r,o).sort(),g=Math.abs(p-_)/n,h=_,x=p,y=t.range(h,x,g),v=[],b=0;b<y.length;b+=1){l=y[b],c=m.map((function(t){return[Math.abs(t[0]-l),t[0],t[1],t[2]]})).sort().slice(0,i),d=t.max(c)[0];var w=Le(c=c.map((function(t){return{w:(e=t[0]/d,Se(e,3)*t[3]),x:t[1],y:t[2]};var e})));f=w.x0,u=w.beta,v.push(f+u*l)}return{x:y,y:v}}function Xe(e){return"count"===e.format?function(r){var a;return a=r%1!=0?t.format(",."+e.decimals+"f"):t.format(",.0f"),e.yax_units_append?a(r)+e.yax_units:e.yax_units+a(r)}:function(r){var a=(e.decimals?"."+e.decimals:"")+"%";return t.format(a)(r)}}MG.register("missing-data",(function(e){var r=this;this.init=function(e){r.args=e,wt(e),kt(e);var a=t.select(e.target);Ct(a,e);var n,o,i=a.selectAll("svg");if(Mt(i,e),Dt(i=Gt(i,e),e),Ot(i,e),n=e.target,t.select(n).selectAll("svg *").remove(),i.classed("mg-missing",!0),(o=e.legend_target)&&t.select(o).html(""),X(e),e.show_missing_background){!function(t){for(var e=[],r=1;r<=50;r++)e.push({x:r,y:Math.random()-.03*r});t.data=e}(e),function(e){e.scales.X=t.scaleLinear().domain([0,e.data.length]).range([p(e),m(e)]),e.scalefns.yf=function(t){var r=t.y;return e.scales.Y(r)}}(e),function(e){e.scales.Y=t.scaleLinear().domain([-2,2]).range([e.height-e.bottom-2*e.buffer,e.top]),e.scalefns.xf=function(t){var r=t.x;return e.scales.X(r)}}(e);var s=x(i,"mg-missing-pane");!function(t,e){var r=e.title,a=e.buffer,n=e.title_y_position,o=e.width,i=e.height;t.append("svg:rect").classed("mg-missing-background",!0).attr("x",a).attr("y",a+2*(r?n:0)).attr("width",o-2*a).attr("height",i-2*a-2*(r?n:0)).attr("rx",15).attr("ry",15)}(s,e),function(e,r){var a=r.scalefns,n=r.interpolate,o=r.data,i=t.line().x(a.xf).y(a.yf).curve(n);e.append("path").attr("class","mg-main-line mg-line1-color").attr("d",i(o))}(s,e),function(e,r){var a=r.scalefns,n=r.scales,o=r.interpolate,i=r.data,s=t.area().x(a.xf).y0(n.Y.range()[0]).y1(a.yf).curve(o);e.append("path").attr("class","mg-main-area mg-area1-color").attr("d",s(i))}(s,e)}return function(t,e){var r=e.missing_text,a=e.width,n=e.height;t.selectAll(".mg-missing-text").data([r]).enter().append("text").attr("class","mg-missing-text").attr("x",a/2).attr("y",n/2).attr("dy",".50em").attr("text-anchor","middle").text(r)}(i,e),r.windowListeners(),r},this.windowListeners=function(){return ae(r.args),r},this.init(e)}),{top:40,bottom:30,right:10,left:0,buffer:8,legend_target:"",width:350,height:220,missing_text:"Data currently missing or unavailable",scalefns:{},scales:{},show_tooltips:!0,show_missing_background:!0}),MG.raw_data_transformation=Ce,MG.process_line=Re,MG.process_histogram=Ee,MG.process_categorical_variables=function(t){return"vertical"===t.bar_orientation?t.x_accessor:t.y_accessor,"vertical"===t.bar_orientation?t.y_accessor:t.x_accessor,this},MG.process_point=Ye,MG.add_ls=$e,MG.add_lowess=function(e){var r=A(e.target),a=e.lowess_line,n=t.svg.line().x((function(t){return e.scales.X(t.x)})).y((function(t){return e.scales.Y(t.y)})).interpolate(e.interpolate);r.append("path").attr("d",n(a)).attr("class","mg-lowess-line")},MG.lowess_robust=function(e,r,a,n){var o,i,s=[];for(t.mean(r),i=0;i<e.length;i+=1)s.push(1);var c=(o=je(e,r,a,n,s)).x,l=o.y;for(i=0;i<100;i+=1){s=t.zip(l,r).map((function(t){return Math.abs(t[1]-t[0])}));var u=t.quantile(s.sort(),.5);c=(o=je(e,r,a,n,s=s.map((function(t){return Se(t/(6*u),2)})))).x,l=o.y}return t.zip(c,l).map((function(t){var e={};return e.x=t[0],e.y=t[1],e}))},MG.lowess=function(t,e,r,a){for(var n=[],o=0;o<t.length;o+=1)n.push(1);je(t,e,r,a,n)},MG.least_squares=Pe;var Ue=function(t,e,r,a){return"string"==typeof t?MG.time_format(a,t)(e[r]):"function"==typeof t?t(e):e[r]},Ne=function(e,r,a){return"string"==typeof e?t.format("s")(r[a]):"function"==typeof e?e(r):r[a]};function Be(t,e,r,a,n){var o,i=function(t){if(t.rollover_time_format)return MG.time_format(t.utc_time,t.rollover_time_format);switch(t.processed.x_time_frame){case"millis":return MG.time_format(t.utc_time,"%b %e, %Y  %H:%M:%S.%L");case"seconds":return MG.time_format(t.utc_time,"%b %e, %Y  %H:%M:%S");case"less-than-a-day":case"four-days":return MG.time_format(t.utc_time,"%b %e, %Y  %I:%M%p")}return MG.time_format(t.utc_time,"%b %e, %Y")}(t);return o="string"==typeof e[a]?function(t){return t}:Xe(t),null!==r?n?Ue(r,e,a,t.utc):Ne(r,e,a):n?i(new Date(+e[a]))+"  ":(t.time_series?"":a+": ")+o(e[a])+"   "}function Ie(t,e){return Be(t,e,t.x_mouseover,t.x_accessor,t.time_series)}function He(t,e){return Be(t,e,t.y_mouseover,t.y_accessor,!1)}function qe(t,e){return Be(t,e,t.x_mouseover,"key",t.time_series)}function Ve(e,r){return function(){for(var a=this,n=a.cloneNode(),o=a.getTotalLength()||0,i=(n.setAttribute("d",e),n).getTotalLength()||0,s=[0],c=0,l=r/Math.max(o,i);(c+=l)<1;)s.push(c);s.push(1);var u=s.map((function(e){var r=a.getPointAtLength(e*o),s=n.getPointAtLength(e*i);return t.interpolate([r.x,r.y],[s.x,s.y])}));return function(t){return t<1?"M"+u.map((function(e){return e(t)})).join("L"):e}}}function We(e){console.error("ERROR : ",e.target," : ",e.error),t.select(e.target).select(".mg-chart-title").append("tspan").attr("class","fa fa-x fa-exclamation-circle mg-warning").attr("dx","0.3em").text("ÔÅ™")}return MG.format_rollover_number=Xe,MG.path_tween=Ve,MG.render_markup=function(r){switch("undefined"==typeof window?"undefined":e(window)){case"undefined":return function(e){var r,a=MG.virtual_window,n=t.select(a.document),o=a.document.createElement("div"),i=global.d3,s=global.window,c=global.document;global.d3=n,global.window=a,global.document=a.document;try{e(o)}catch(t){r=t}if(global.d3=i,global.window=s,global.document=c,r)throw r;return n.select((function(){return o})).html()}(r);default:return function(e){var r=document.createElement("div");return e(r),t.select(r).html()}(r)}},MG.init_virtual_window=function(t,e){if(!MG.virtual_window||e){var r=t.jsdom({html:"",features:{QuerySelector:!0}});MG.virtual_window=r.defaultView}},MG.error=We,MG}));